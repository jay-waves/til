## 克莱姆 (Cramer) 方法

克莱姆法则 (Cramer’s Rule) 使用行列式来求解线性方程组. 

对于线性方程组: $$\begin{cases}  
a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n = b_1 \\  
a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n = b_2 \\  
\vdots \\  
a_{n1}x_1 + a_{n2}x_2 + \cdots + a_{nn}x_n = b_n  
\end{cases}$$

设系数矩阵 $A$ 的行列式 $D=|A|\not=0$, 则方程组有唯一解: $x_{i}=\frac{D_{i}}{D}$

其中 $D_i$ 是将系数矩阵 $A$ 的第 $i$ 列替换为常数列 $\hat{b}$ 后的行列式.
$$D_i =  
\begin{vmatrix}  
a_{11} & \cdots & b_1 & \cdots & a_{1n} \\  
a_{21} & \cdots & b_2 & \cdots & a_{2n} \\  
\vdots & & \vdots & & \vdots \\  
a_{n1} & \cdots & b_n & \cdots & a_{nn}  
\end{vmatrix}$$

只适合规模不大的方程, 并且要求系数矩阵非奇异.

### 证明 

$$det(D_{i})=\det(\mathbf{a}_{1},\dots,\mathbf{b},\dots,\mathbf{a}_{n})=\det(\mathbf{a_{1}},\dots,x_{1}\mathbf{a_{1}}+\dots+x_{n}\mathbf{a}_{n},\dots,\mathbf{a}_{n})$$

将行列式按第 $i$ 列展开:

$$\begin{align}
&det(D_{i})\\
&=x_{1}\det(\mathbf{a}_{1},\dots,\mathbf{a_{1}},\dots,\mathbf{a}_{n})+\dots+x_{i}\det(\mathbf{a}_{1},\dots,\mathbf{a}_{i},\dots,\mathbf{a}_{n})+\dots \\
&=x_{i}\det(A)\\&=x_{i}D
\end{align}
$$

于是有: $$x_{i}=\frac{D_{i}}{D}$$

## 高斯 (Gauss) 消去法

本质上两种方法都首先构建了一个增广矩阵: 

$$
[\mathbf{A,b}]=\begin{bmatrix}
    a_{11} & \cdots & a_{1n} & b_1 \\
    \vdots & \ddots & \vdots & \vdots  \\
    a_{n1} & \cdots & a_{nn} & b_n \\
\end{bmatrix}
$$

然后按行进行初等变化, 使得矩阵变为如下的形式: 

$$
\begin{bmatrix}
    1 & \cdots & a_{1n}' & b_1' \\
     & \ddots & \vdots & \vdots   \\
    \mathbf{0} &  & 1 & b_n' \\
\end{bmatrix}
$$

代回, 变化成下面的矩阵, 得到的即为向量 $\mathbf{x}$ 的解: 

$$
\begin{bmatrix}
    \mathbf{I}_{n\times n} & \mathbf{b'}_{n\times 1}
\end{bmatrix}
$$

### LU 分解

用高斯消除法求解[非齐次线性方程组](../linalg/线性方程组/线性方程组的解.md) $A\cdot x=b$, 也被称为矩阵 $L\cdot U$ 分解. 
每一步高斯消去, 等价于用一个单位下三角矩阵 $L_{k}^{-1}$ 左乘 $A$, 将所有行变换操作连乘, 得到 $L^{-1}A=U$, 即 $A=LU$. 

高斯消去法的充要条件是**所有顺序主子式都非零**, 即每一步都不会遇到零主元 (对角元). 如果某步主元为零 (或者非常小, 为了数值稳定性), 需要将其与非零行交换, 引入置换矩阵 $P$: $PA=LU$. 

### 三角分解法

$$Ax=LUx=Ly=b$$, 求解时, 先求 $y$, 然后求 $x$.

对于 ${} Doolittle$ 分解, $L$ 为单位下三角阵 (主对角元为1), $U$ 为上三角阵:

$$
\mathbf{L}=\begin{bmatrix} 1 & 0 & 0 & \dots & 0 \\ l_{21} & 1 & 0 & \dots & 0 \\ l_{31} & l_{32} & 1 & \dots & 0 \\ \vdots & \vdots & \vdots & \ddots & 0 \\ l_{n1} & l_{n2} & l_{n3} & \dots & 1 \\
\end{bmatrix} \quad
\mathbf{U}=\begin{bmatrix} u_{11} & u_{12} & u_{13} & \dots & u_{1n} \\ 0 & u_{22} & u_{23} & \dots & u_{2n} \\ 0 & 0 & u_{33} & \dots & u_{3n} \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & 0 & \dots & u_{nn} \\
\end{bmatrix}
$$

对于 *$Crout$ 分解*, $L$ 为下三角阵, $U$ 为单位上三角阵:

$$
\mathbf{L}=\begin{bmatrix} l_{11} & 0 & 0 & \dots & 0 \\ l_{21} & l_{22} & 0 & \dots & 0 \\ l_{31} & l_{32} & l_{33} & \dots & 0 \\ \vdots & \vdots & \vdots & \ddots & 0 \\ l_{n1} & l_{n2} & l_{n3} & \dots & l_{nn} \\
\end{bmatrix} \quad
\mathbf{U}=\begin{bmatrix} 1 & u_{12} & u_{13} & \dots & u_{1n} \\ 0 & 1 & u_{23} & \dots & u_{2n} \\ 0 & 0 & 1 & \dots & u_{3n} \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & 0 & \dots & 1 \\
\end{bmatrix}
$$

**Doolittle 和 Crout 分解的充分必要条件都为 $\mathbf{A}_{n\times n}$ 的前 $n-1$ 个顺序主子式不为零.**

## 病态方程问题

对非奇异矩阵 $A$ (可逆矩阵), 定义其*条件数*为: $$cond(A)=\Vert A\Vert \cdot\Vert A^{-1}\Vert$$, 其中 $\Vert A\Vert$ 为某种矩阵范数.

推论: 

* **任意非奇异矩阵 $A$, 总有 $cond(A)\geq 1$**

* **$A$ 是非奇异矩阵, $k\neq 0$ 是常数, 则有 ${} cond(kA)=cond(A) {}$.**

* **条件数越大, 方程越病态, 微小扰动会导致数值解巨大变化**, 满足: $$\frac{\Vert\delta x\Vert}{\Vert x\Vert}\leq cond(A)\frac{\Vert\delta b\Vert}{\Vert b\Vert}$$

## 迭代法

对于大型稀疏矩阵, 上述精确算法效率低. 迭代法可以快速逼近解.

### 简单迭代法

对于简单迭代法，将原方程组改写为:

$$
\begin{cases}
Ax=(N-P)x=b \\
Nx=Px+b \\
x=N^{-1}Px+N^{-1}b=Gx+d
\end{cases}
$$

迭代式为:
$$
\mathbf{x}^{(k+1)}=\mathbf{Gx}^{(k)}+\mathbf{d}
$$

#### 迭代法的收敛条件

**定理一: 迭代法的收敛, 当且仅当, [谱半径](../linalg/对称矩阵.md)满足 $\rho(G)< 1$**

**定理二: 如果矩阵 $G$ 的某种矩阵范数满足 $\Vert G\Vert<1$, 那么迭代法也收敛且解唯一**. 此时有误差估计公式:

   $$
   ||\mathbf{x}^{(k)}-\mathbf{x}^*||\le \frac{||\mathbf{G}||^k}{1-||\mathbf{G}||}||\mathbf{x}^{(1)}-\mathbf{x}^{(0)}||
   $$
   $$
   ||\mathbf{x}^{(k)}-\mathbf{x}^*||\le \frac{||\mathbf{G}||}{1-||\mathbf{G}||}||\mathbf{x}^{(k)}-\mathbf{x}^{(k-1)}||
   $$

### Jacobi 迭代法

将原矩阵拆为三部分: 

$$\mathbf{A = D+L+U}$$, 其中, $D$ 是对角阵, $L,U$ 是严格三角阵.

这样原来的迭代方法有：
$$
\mathbf{x}^{(k+1)}=[\mathbf{-D}^{-1}(\mathbf{L+U})]\mathbf{x^{(k)}}+\mathbf{D}^{-1}\mathbf{b}
$$

Jacobi 有一个额外的**收敛定理**: 

**若矩阵 $\mathbf{A}$ 是按行/按列严格占优阵** ($|a_{ii}|>\Sigma_{i\ne j}|a_{ij}|$), **那么 Jacobi 迭代法必然收敛, 同时 $A$ 近似非奇异矩阵.**

> 证明可以参考 [盖尔圆盘定理](矩阵特征计算.md).

### Gauss-Seidel (GS) 迭代方法

Gauss-Seidel 方法在 Jacobi 方法上做了一些调整, 保持矩阵 $\mathbf{D},\mathbf{L},\mathbf{U}$ 不变, 调整迭代方法:
$$
\mathbf{x}^{(k+1)}=[\mathbf{-(D+L)}^{-1}\mathbf{U}]\mathbf{x^{(k)}}+[\mathbf{(D+L)}^{-1}\mathbf{b}]
$$

GS 方法也有一个额外的**收敛定理**: **若 $A$ 为正定矩阵, 那么 GS 方法收敛**.

### 逐次超松弛 (SOR) 迭代法

...
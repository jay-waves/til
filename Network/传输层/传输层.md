只有在网络边缘才有传输层, 传输层功能有:
- 提供**主机进程**间端到端通讯, 而网络层仅仅是主机间通信.
- 对报文数据部分进行差错检测, 而IP报文校验和仅检查首部.

**复用和分用**: 运输层涉及不同进程 (应用层) 进行协议复用, 仅用IP来标识收发者是不够的, 需要引入端口号来标识同一IP地址的不同进程. 16位端口号有服务器端口号, 和客户端端口号, 服务器端口号有**系统端口号**和登记端口号两种, TCP/IP中最重要的应用程序有独有的系统端口号.

> 标识进程不适用PID, 而使用端口号, 是为了规避不同操作系统的规范差别.

传输层协议主要分为:
- 面向无连接的[udp](udp.md)
- 面向连接的[tcp](tcp.md)

|          | UDP        | TCP                  |
| -------- | ---------- | -------------------- |
| 是否连接 | 无连接     | 面向连接             |
| 是否可靠 | 不可靠     | 可靠(流量和拥塞控制) |
| 连接对象 | 支持多对多 | 只能一对一           |
| 传输方式 | 面向报文   | 面向字节流           |
| 首部开销 | 8字节      | 至少20字节, 至多60字节                     |

## 可靠传输

- 停止-等待协议, SW
- 回退N帧协议, GBN
- 选择重传协议, SR
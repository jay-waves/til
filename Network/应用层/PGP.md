PGP (Pretty Good Privacy) 是一种流行加密协议, 用于电子邮件和文件传输的加密和电子签名. 
由 Phil Zimmermann 于 1991 年开发, 最初是闭源软件. 后续发布了 OpenPGP 规范 (RFC 4880), 
定义了开放 PGP 标准, 后续流行的开源版本为 GPG (GNU Privacy Guard). 


| 服务         | 功能     | 算法          | 描述               |
| ------------ | -------- | ------------- | ------------------ |
| **认证**     | 数字签名 | [DSS](Security/密码学/公钥密码/数字签名/数字签名.md#3%20DSA%20数字签名)/[RSA](Security/密码学/公钥密码/RSA/RSA.md) + [SHA](../../Security/密码学/消息摘要/消息摘要.md) | 哈希和数字签名套件 |
| **保密**     | 消息加密 | CAST5, [AES](../../Security/密码学/分组密码/SP%20结构/AES.md), [IDEA](../../Security/密码学/分组密码/SP%20结构/IDEA.md), [3DES](../../Security/密码学/分组密码/Feistel%20结构/EDE.md), Blowfish    | 内容对称加密       |
| **压缩**     |          | ZIP           |                    |
| **邮件兼容** | 兼容 MIME 标准         | [Base64](Network/应用层/Char%20Encoding/Base%20编码.md)        | 将加密消息转化为 [ACSII](Network/应用层/Char%20Encoding/字符编码.md) 串                 |

PGP 加密电子邮件时, 与 [MIME](Network/应用层/E-Mail.md) (Multipurpose Internet Mail Extension) 结合在一起形成 PGP/MIME 标准.

PGP 依赖于[公钥基础设施](Security/密码学/安全协议/密钥分发与管理.md)进行管理和分发, 但自身没有完善证书管理体系. 支持公钥信任链.

| 加密协议   | [SSL/TLS](Network/VPN/SSL.md)                                         | PGP                                                                   |
| ---------- | --------------------------------------------------------------------- | --------------------------------------------------------------------- |
| 网络层次   | 表示层                                                                | 应用层                                                               |
| 保护对象   | TCP 连接通道                                                          | 电子邮件内容和附件, 不包括邮件头部                                    |
| 持久性     | 传输至接收方后立即解密                                                | 传输完成后仍持久加密, 直到接收方主动正确解密                          |
| 邮件兼容性 | SSL/TLS 透明地嵌入 [SMTP](Network/应用层/E-Mail.md#SMTP) 下层, 交付给 SMTP 后再加密, 使用 TCP 465 端口 | PGP 先行加密, 再交付给 SMTP. 从这点看, PGP 更像是独立的**应用层加密工具** |
| 保密场景   | 服务器间加密连接, 由于企业等场景存在 SSL 提前卸载再转发到端, 并不是端到端加密的                                                      | 端到端加密, 内容只被受授权方查看                                                                      |

## PGP 工作流程

PGP 工作流程采用混合加密 (hybrid encryption), 混合使用公钥和对称密码.

符号说明:
- $PK',SK'$ 发送者公钥对
- $PK, SK$ 接收者公钥对
- $K$ 双方将使用的会话密钥
- $Hash$ 哈希算法

### 1. 发送方

1. 发送方首先生成一个随机的**[对称密钥](../../Security/密码学/分组密码/分组密码.md)** $K$ 作为本次[会话密钥](Security/密码学/安全协议/密钥分发与管理.md).
2. 使用会话密钥 $K$ 对消息内容 $M$ 加密: $$C_{M}=\{ M \}_{K}$$
3. 发送方会提前获知接收者的公钥 $PK$, 对会话密钥进行加密: $$C_{K}=\{ K \}_{PK}$$
4. (可选) 对原始消息 $M$ 进行[数字签名](Security/密码学/公钥密码/数字签名/数字签名.md), 供接收方确认消息真实性和完整性: $$S=\{ Hash(M)\}_{SK'}$$
5. 将消息打包发送给接收方: $$\{ C_{M},C_{K}, (S) \}$$

### 2. 接收方

1. 接收方用自己的私钥 $SK$ 解密会话密钥: $$K=\{ C_{K} \}_{SK}$$
2. 接收方用会话密钥 $K$ 解密消息内容: $$M=\{ C_{M} \}_{K}^{-1}$$
3. (如果有) 验证数字签名, 略. 

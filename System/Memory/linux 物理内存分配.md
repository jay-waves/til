## 伙伴系统

**伙伴系统用于分配页帧, 并管理空隙**.

系统中, 空闲的同样大小的内存块被两两分组, 称为 "伙伴". 当两个伙伴都是空闲的, 就会被内核合并为更大的内存块. 伙伴按内存块大小分级: 1/2/4/8/16 页, 同级别的伙伴, 被放到同一个列表管理. 

当申请内存时, 伙伴系统将大内存块拆半为小内存块; 当释放内存时, 伙伴系统检查是否有连续的内存块, 能够组建为一组空闲伙伴, 合并为更大的内存块. 

### Slab 分配器

*Slab 缓存*专用于将伙伴系统的提供的页, 拆分为**比完整页帧小得多**的内存块. 

- 对于频繁使用的对象, 内核定义了只包含了所需类型对象实例的缓存. 
- 普通的小内存块的分配, 提供按大小分级的缓存.

内核为不同场景提供了备选方案: slab, slub, slob 缓存.
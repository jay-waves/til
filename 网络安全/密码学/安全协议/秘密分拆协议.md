秘密分拆协议 (Secret Sharing Scheme) 将一个秘密分解成多个部分 (称为分片或分享), 分发给参与者. 只有特定数量或组合的参与者合作时才能重建秘密. 

> 类似概念还有: 门限加密 (Threshold Enc), 安全多方计算等. 

如果任何可能秘密值以等概率被攻击者误认为是真实秘密, 则称一个秘密共享方案是[**完美的**](../可证明安全.md). 

## Shamir 秘密分拆

Shamir 秘密分拆协议基于[拉格朗日插值多项式](../../../数学/数值分析/插值与多项式逼近.md). 构造阶数为 $t-1$ 的多项式 $f(x)$, 将秘密 $s$ 设置为常数项 $f(0)=s$.
1. 随机生成 $t-1$ 个系数 $a_1, a_2, ..., a_{t-1}$, 构造多项式 $f(x) = s + a_1x + a_2x^2 + \ldots + a_{t-1}x^{t-1}$. 
2. 计算多项式在 $n$ 个不同点的值 $(x_1, f(x_1)), (x_2, f(x_2)), ..., (x_n, f(x_n))$, 将这些值分发给参与者. 
3. 任何 $t$ 个分片可以通过拉格朗日插值法重建多项式 $f(x)$, 从而恢复秘密 $s = f(0)$.

支持严格 $t$ 门限安全性, 少于 $t$ 个分片时, $s$ 的可能性分布与分片无关 (信息论安全的?). 多项式常在有限域上构造, 对于 $t$ 个分片, 确定的插值多项式是唯一的.   

## Blakley 秘密分拆

Blakley 秘密分拆方案将秘密表示为 $t$ 维空间中的某点的坐标, 分片则是经过该点的超平面方程.
1. 假设秘密 $s$ 是 $t$ 维向量: $s=(s_{1},s_{2},s_{3},\dots,s_{t})$, 表示 $t$ 维欧氏空间中的点.
2. 每个参与者得到一个代表超平面方程的系数: $$a_{1}x_{1}+a_{2}x_{2}+\dots+a_{t}x_{t}=b$$, 其中 $a_{i}$ 都是随机生成的, 并且不同分片线性无关, 常数 $b$ 是通过代入秘密 $s$ 求得.
3. 分片分配给 $n$ ($n\geq t$) 个参与者后, 得到 $n$ 个线程方程 (超平面): $$A\cdot X=B$$
4. 恢复秘密时, 至少需要 $t$ 个线性方程, 组成 $t\times t$ [线性方程组](../../../数学/线性代数/线性方程组/线性方程组的解.md), 用于恢复秘密: $$X=A_{t}^{-1}\cdot B_{t}$$

Blakley 方案多用于教学, 在基本原理上和 Shamir 是等价的, 因为多项式插值问题可以归约到线性方程组问题上, 它们都是信息论安全的 (完美保密的). Blakley 方案中攻击者可以通过 $t-1$ 个分片恢复出一个高维子空间 (一条线), 常见误解认为这样泄露了部分秘密, 所以不是完美保密的. 但即使子空间是一条线, 在足够大的数域上, 每个点是秘密的概率都是等可能的, 仍具有完美保密性.

但是 Blakley 方案在空间复杂度上弱于 Shamir 方案.

## IDS 秘密分拆

基于信息分离 (Information Dispersal Scheme, IDS) 的秘密分拆方案, 使用信息论纠错码来构建.
1. 使用纠删码 (如 [Reed-Solomon Codes](../../../数学/信息论/里所码.md)) 对秘密进行编码生成 $n$ 个分片. 
2. 分发分片给参与者. 
3. 至少收集 $t$ 个分片后, 通过解码算法重建秘密.

基于纠删码原理, 工具和应用广泛.

## CRT 秘密分拆

基于[中国剩余定理 (CRT)](../../../数学/数论/中国剩余定理.md) 的秘密分拆方案.
1. 选择互质的模数 $m_1, m_2, ..., m_n$, 确保 $M = m_1 \times m_2 \times ... \times m_t > s$. 
2. 计算分片 $s_i = s \mod m_i$. 
3. 给每个参与者分发一个分片 $(m_i, s_i)$. 
4. 收集至少 $t$ 个分片, 通过中国剩余定理恢复秘密 $s$.

局限是仅能保存整数秘密, 编码灵活性较差.

## 基于同态加密

...


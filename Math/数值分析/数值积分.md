数值积分求积公式的一般形式为: $$\int^{b}_{a}f(x)\mathrm{d}x\approx \sum^{n}_{k=0}\lambda_{k}f(x_{k})$$

求积节点 $x_{i}$ 满足: $a\leq x_{0}<x_{1}<\dots<x_{n}\leq b$. 

求积公式的截断误差为: $$R_{n}=\int^{b}_{a}f(x)\mathrm{d}x- \sum^{n}_{k=0}\lambda_{k}f(x_{k})$$

**定义**: 当 $f(x)$ 为任何次数不高于 $m$ 的多项式时, 求积公式 $R_{n}=0$; 而当 $f(x)$ 为 $m+1$ 次多项式时, $R_{n}\neq 0$, 则称 $f(x)$ 具有 $m$ 次代数精度. 

## 插值型求积公式

用 [Lagrange 插值系数](插值与多项式逼近.md)构造积分系数: $$\lambda_{k}^{(n)}=\int^{b}_{a}l_{k}(x)\mathrm{d}x=\int^{b}_{a}\prod^{n}_{i=0,i\neq k} \frac{x-x_{i}}{x_{k}-x_{i}}\mathrm{d}x$$

此时截断误差为: $$R_{n}=\int^{b}_{a} \frac{f^{(n+1)}(\xi)}{(n+1)!}\prod^{n}_{j=0}(x-x_{j})\mathrm{d}x$$, 其中, ${} \xi=\xi(x)\in (a,b) {}$

## Newton-Cotes 求积公式

令 $x=a+th,\,h=\frac{b-a}{n}$, 此时由插值型积分公式, 有系数:

$$
\def\D{\mathrm{d}}
\begin{align}
\lambda_{k}^{(n)} 
&=\int_{a}^{b}{l}_{k}\,(x)\D x
=\int_{a}^{b}\left(\prod_{j=0}^{n}{\frac{x-x_{j}}{x_{k}-x_{j}}}\right)\D x
=\int_{0}^{n}\left(\prod_{j=0}^{n}{\frac{\,t-j}{k-j}}\right)h\D t \\
&={\frac{(-1)^{n-k}h}{k!\,(n-k)!}}\int_{0}^{n} \left[\prod_{j=0,j\neq k}^{n}(t-j)\,\right]\D t=\,(b-a)\,c_{k}^{(n)}\quad(k=0,1,\cdots,n)
\end{align}$$

$c_{k}^{(n)}$ 称为 Cotes 系数, 和被积函数 $f(x)$, 区间 $[a,b]$ 均无关. 可以直接查表.

记 Newton-Cotes 求积公式为: $$\int^{b}_{a}f(x)\,dx\approx \sum_{k=0}^{n}\lambda_{k}^{(n)}f\left(a+k\,\frac{b-a}{n}\right)$$

其中, 截断误差为: $$\def\D{\mathrm{d}}
R_{n}=\int_{a}^{b}\frac{f^{(n+1)}(\xi)\,}{\left(n+1\right)!}\left[\prod_{j=0}^{n}\left(\,{x-x_{j}}\,\right)\right]\D{x}
=\frac{h^{n+2}}{(n+1)!}\int^{n}_{0} f^{(n+1)}(\xi)\left[ \prod^{n}_{j=0}(t-j) \right] \D{x}$$

其中, $\xi=\xi(a+th)\in (a,b)$. 

<br> 

**定理**

### 梯形积分

### 复化梯形积分

### Simpson 积分

### 稳定性
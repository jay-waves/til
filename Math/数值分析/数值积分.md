数值积分求积公式的一般形式为: $$\int^{b}_{a}f(x)\mathrm{d}x\approx\sum^{n}_{k=0}\lambda_{k}f(x_{k})$$

求积节点 $x_{i}$ 满足: $a\leq x_{0}<x_{1}<\dots<x_{n}\leq b$. 

求积公式的截断误差为: $$R_{n}=\int^{b}_{a}f(x)\mathrm{d}x- \sum^{n}_{k=0}\lambda_{k}f(x_{k})$$

**定义**: 当 $f(x)$ 为**任何**次数不高于 $m$ 的多项式时, 求积公式 $R_{n}=0$; 而当 $f(x)$ 为 $m+1$ 次多项式时, $R_{n}\neq 0$, 则称该数值积分公式具有 $m$ 次代数精度. 

对于一个 $n$ 点求积公式, 含有 $n$ 个节点 $x_{i}$ 和 $n$ 个权 $A_{i}$, 共计 $2n$ 个未知数. 要求它对多项式 $\set{1,x,x^{2},\dots,x^{m}}$ 都精准, 至少要满足 $m+1$ 个独立方程. 也就是说, 至少 $m+1>2n$, 这限制了求积公式的最高代数精度.

## 插值型求积公式

用 [Lagrange 插值系数](插值与多项式逼近.md)构造积分系数: $$\lambda_{k}^{(n)}=\int^{b}_{a}L_{k}(x)\mathrm{d}x=\int^{b}_{a}\prod^{n}_{i=0,i\neq k} \frac{x-x_{i}}{x_{k}-x_{i}}\mathrm{d}x$$

此时, 原积分可表示为数值形式: $$\int^{b}_{a}f(x)dx\, dx \approx \int^{b}_{a}\sum^{n}_{i=0}f(x_{i})\cdot L_{i}(x) \, dx =\sum^{n}_{i=0}f(x_{i})\int^{b}_{a}L_{i}(x) \, dx $$

截断误差为: $$R_{n}=\int^{b}_{a} \frac{f^{(n+1)}(\xi)}{(n+1)!}\prod^{n}_{j=0}(x-x_{j})\mathrm{d}x$$, 其中, $\xi=\xi(x)\in (a,b)$

### Newton-Cotes 求积公式

令 $x=a+th,\,h=\frac{b-a}{n}$, 此时由插值型积分公式, 有系数:

$$
\def\D{\mathrm{d}}
\begin{align}
\lambda_{k}^{(n)} 
&=\int_{a}^{b}{l}_{k}\,(x)\D x
=\int_{a}^{b}\left(\prod_{j=0}^{n}{\frac{x-x_{j}}{x_{k}-x_{j}}}\right)\D x
=\int_{0}^{n}\left(\prod_{j=0}^{n}{\frac{\,t-j}{k-j}}\right)h\D t \\
&={\frac{(-1)^{n-k}h}{k!\,(n-k)!}}\int_{0}^{n} \left[\prod_{j=0,j\neq k}^{n}(t-j)\,\right]\D t=\,(b-a)\,c_{k}^{(n)}\quad(k=0,1,\cdots,n)
\end{align}$$

$c_{k}^{(n)}$ 称为 Cotes 系数, 和被积函数 $f(x)$, 区间 $[a,b]$ 均无关. 可以直接查表.

记 Newton-Cotes 求积公式为: $$\int^{b}_{a}f(x)\,dx\approx \sum_{k=0}^{n}\lambda_{k}^{(n)}f\left(a+k\,\frac{b-a}{n}\right)$$

其中, 截断误差为: $$\def\D{\mathrm{d}}
R_{n}=\int_{a}^{b}\frac{f^{(n+1)}(\xi)\,}{\left(n+1\right)!}\left[\prod_{j=0}^{n}\left(\,{x-x_{j}}\,\right)\right]\D{x}
=\frac{h^{n+2}}{(n+1)!}\int^{n}_{0} f^{(n+1)}(\xi)\left[ \prod^{n}_{j=0}(t-j) \right] \D{x}$$

其中, $\xi=\xi(a+th)\in (a,b)$. 

<br> 

**定理**

**定理: 对于 $n$ 个求积节点的 New-Cotes 求积公式, 其代数精度为 $n-1$** 

### 梯形积分

### 复化梯形积分

### Simpson 积分

## Gauss 型积分公式

定义高斯求积: $$Q(f)=\sum^{n}_{i=0}A_{i}f(x_{i}),\quad A_{i}=\int^{b}_{a}\rho(x)L_{i}(x) \, dx $$, 其中 $x_{i}$ 是 $n$ 次正交多项式 $\varphi(x)$ 的互异实数根. $L_{i}$ 是以 $x_{i}$ 为节点的拉格朗日基函数.

**定理: Gauss 积分公式的代数精度为 $2n-1$, 是 $n$ 节点求积公式中的最高代数精度**.

<br>

**证明:** 

* 首先证明: Gauss 求积的代数精度至少为 $2n-1$. 

对任意多项式 $p(x),\quad \deg p\leq 2n-1$, 对 $\varphi(x)$ 作带余除法:  $$p(x)=q(x)\varphi(x)+r(x),\quad \deg q\leq n-1,\deg r\leq n-1$$

于是 $$I(p)=\int\rho\ p=\int\rho\ q\ \varphi+\int \rho\ r$$

又因为 $\varphi(x)$ 与任意次数小于等于 $n-1$ 次的多项式正交, 因此: $$\int^{b}_{a}\rho(x)q(x)\varphi(x)\, dx=0$$

从而 $$I(p)=\int  \rho\ r=I(r)$$

从另一面, $$Q(p)=Q(q\ \varphi)+Q(r)$$ 

因为所有求积节点 $x_{i}$ 都是 $\varphi$ 的实数根, 所以 $$Q(q\varphi)=\sum^{n}_{i=1}A_{i}q(x_{i})\cdot \varphi(x_{i})=0$$

因为 $\deg r\leq n-1$, 所以普通插值求积公式即可满足精度 $n-1$, 即 $$I(r)=Q(r)$$

综上, $$Q(p)=0+Q(r)=I(r)=I(p)$$ 这意味着 Gauss 求积公式的代数精度至少为 $2n-1$.

* 其次证明: Gauss 求积的代数精度不可能超过 $2n-1$.

举一个反例证明 Gauss 求积公式的精度不是 $2n$ 的: $p(x)=(\varphi(x))^{2}$

此时 $Q(p)=0$, 但是 $I(p)=\int \rho(x)(\varphi(x))^{2} \, dx>0$. 显然 $Q(p)\neq I(p)$. 

$\blacksquare$

### Gauss 求积公式的误差

仍取 $w_{n}(x)=\prod^{n}_{i=1}(x-x_{i})$. 由于正交多项式的唯一性, $w_{n}(x)$ 应该和上述 $\varphi(x)$ 仅差一个常数因子.  

$$R_{n}=I(f)-Q(f)=\frac{f^{(2n)}(\xi)}{(2n)!}\int^{b}_{a}\rho(x)\ (w_{n}(x))^{2}\, dx$$, 其中 $\xi\in (a,b)$

由误差可知: $\deg f\leq 2n-1$ 时, $f^{(2n)}\equiv 0$; $\deg f=2n$ 时, $f^{(2n)}$ 为常数, ${} R_{n}\neq 0 {}$.

### Gauss-Legendre 求积公式

### Gauss-Laguerre 求积公式

### Gauss-Hermite 求积公式
设 $W_{1},W_{2}$ 是线性空间 $V$ 的子空间. 若 $W_{1}+W_{2}$ 中任意向量**均唯一地**表示为 $W_{1}$ 中的一个向量和 $W_{2}$ 中的一个向量之和, 则称 $W_{1}+W_{2}$ 是 $W_{1},W_{2}$ 的*直和*. 记为 $\large W_{1}\dotplus W_{2}$

若 $W_{1}\perp W_{2}$, 则称 $W_{1}\dotplus W_{2}$ 是 $W_{1},W_{2}$ 的正交直和, 记为 $W_{1}\oplus W_{2}$. $W_{2}$ 称为 $W_{1}$ 的正交补空间, 记为 ${} W_{2}=W_{1}^{\perp} {}$

<br>

**直和判定定理**: $W_{1},W_{2}$ 是线性空间的两个子空间, 以下命题等价:
1. $W_{2}+W_{1}$ 是直和
2. $W_{1}+W_{2}$ 中零元素的表示法唯一
3. $W_{1}\cap W_{2}=\emptyset$
4. $dim(W_{1}+W_{2})=dimW_{1}+dimW_{2}$

## 投影

设 $V=W_{1}\dotplus W_{2}$, 其中任意向量 $x\in V$ 皆可唯一分解为 $x=y+z$, 其中 $y\in W_{1},z\in W_{2}$. 称 $y$ 为 $x$ 在子空间 $W_{1}$ 上的*投影*.

若 $V=W_{1}\oplus W_{2}$, 则称 $y$ 为向量 $x$ 在 $W_{1}$ 上的*正交投影*. 

### 格拉姆-施密特正交化

将一组线性无关的向量 $\set{\alpha_{1},\alpha_{2},\cdots,\alpha_{n}}$ 正交化. 

$$q_{1}=\alpha_{1}$$

$$q_{2}=\alpha_{2}-\frac{\langle\alpha_{2},q_{1}\rangle}{\langle q_{1},q_{1}\rangle}q_{1}$$

$$\cdots$$

$$q_{k}=\alpha_{k}-\sum^{k-1}_{i=1}\frac{\langle\alpha_{k},q_{i}\rangle}{\langle q_{i},q_{i}\rangle}q_{i}=\alpha_{k}-\sum^{k-1}_{i=1}\langle \alpha_{k},e_{i}\rangle e_{i}$$

其中 $\langle u,v\rangle$ 表示向量内积, $\langle u,u\rangle$ 表示[向量范数](内积空间.md) $\Vert u\Vert$.

如果需要正交单位向量组, 可以将每个正交向量 ${} q_{k}$ 再单位化: $$e_{k}=\frac{u_{k}}{\Vert u_{k}\Vert}$$

### QR 分解

将上述 Gram-Schmidt 正交化过程表示为上三角矩阵: $$(\alpha_{1},\alpha_{2},\cdots,\alpha_{n})=(e_{1},\dots,e_{n})\cdot\begin{bmatrix}
\Vert q_{1}\Vert  & (\alpha_{2},e_{1})  & \dots  & (\alpha_{n},e_{1})\\
0 & \Vert q_{2} \Vert  & \dots & (\alpha_{n},e_{2})  \\
 & 0 & \dots & \vdots  \\
 &  & 0 & \Vert q_{n} \Vert
\end{bmatrix}$$

这其实就是矩阵的 QR 分解, 也叫酉三角分解: $A=QR$. 
- $Q$ 是酉矩阵. 
- $R$ 为上三角矩阵
- **$A\in\mathbb{R}^{m\times n}$ 必须是列满秩的**. 

#### 唯一性

**普通 QR 分解不是唯一的.** 取对角线上元素为 $\pm1$ 的对角矩阵 $D$, 有 $A=QR=(QD)(D^{-1}R)$. $QD$ 仍是正交矩阵, $D^{-1}R$ 仍是上三角矩阵.

**当 $R_{ii}>0$ 时, 即当 $R$ 为正线上三角矩阵时, QR 分解是唯一的**. 

#### 必要条件

对于 $A\in \mathbb{R}^{m\times n}$, 如果 $rank(A)=n$, 也存在 $QR$ 分解: $$A=QR$$, 其中 $Q\in \mathbb{R}^{m\times m}$ 是正交矩阵, $R\in \mathbb{R}^{m\times n}$ 是上三角 (或块上三角). 

### 最小二乘解

在 $W\in V$ 中, 给定向量 $\alpha\in V$, 存在 $x\in W$ 满足: $$\Vert \alpha -x\Vert \leq \Vert \alpha -y\Vert,\quad\forall y\in W$$

则称 $x$ 是 $\alpha$ 在子线性空间 $W$ 的最佳逼近向量. 

最小二乘问题详见 [线性方程组的最小二乘解](../线性方程组/线性方程组的最小二乘解.md).
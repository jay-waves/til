最小二乘解是在线性回归和数据拟合中常用的一种方法，用来找到一组参数，使得模型对数据的误差最小化。具体来说，最小二乘法的目标是最小化误差平方和。

![|300](../../attach/Pasted%20image%2020240908234723.png)


### 问题背景

假设我们有一组数据点 \( (x_1, y_1), (x_2, y_2), \dots, (x_n, y_n) \)，这些数据点之间存在某种关系，我们希望通过某个函数模型 \( f(x) \) 来近似这些数据。通常我们考虑线性模型：
\[
y_i = a_1 x_{i1} + a_2 x_{i2} + \dots + a_m x_{im} + \epsilon_i
\]
其中，\( a_1, a_2, \dots, a_m \) 是我们希望求解的参数，\( \epsilon_i \) 是误差项。

在矩阵形式下，这个问题可以表示为：
\[
\mathbf{y} = X \mathbf{a} + \mathbf{\epsilon}
\]
其中：
- \( \mathbf{y} \) 是 \( n \times 1 \) 的观测向量（包含所有 \( y_i \) 值），
- \( X \) 是 \( n \times m \) 的矩阵，包含每个数据点的特征，
- \( \mathbf{a} \) 是 \( m \times 1 \) 的参数向量，
- \( \mathbf{\epsilon} \) 是 \( n \times 1 \) 的误差向量。

### 最小二乘问题

最小二乘法的目标是找到参数向量 \( \mathbf{a} \)，使得模型预测值与实际观测值之间的差距（误差平方和）最小化。误差平方和表示为：
\[
S(\mathbf{a}) = \sum_{i=1}^n \epsilon_i^2 = \sum_{i=1}^n (y_i - f(x_i))^2
\]
在矩阵形式下，可以写作：
\[
S(\mathbf{a}) = (\mathbf{y} - X \mathbf{a})^T (\mathbf{y} - X \mathbf{a})
\]
即误差向量的平方和。

### 求解最小二乘解

为了找到使误差平方和最小的 \( \mathbf{a} \)，我们可以对 \( S(\mathbf{a}) \) 进行求导，并设导数为零：
\[
\frac{\partial}{\partial \mathbf{a}} S(\mathbf{a}) = -2 X^T (\mathbf{y} - X \mathbf{a}) = 0
\]
解这个方程，可以得到最小二乘解：
\[
\mathbf{a} = (X^T X)^{-1} X^T \mathbf{y}
\]
这是最小二乘法的闭式解，它给出了参数 \( \mathbf{a} \) 的最优解。

### 几何解释

最小二乘解的几何意义可以理解为：我们在多维空间中寻找参数向量 \( \mathbf{a} \)，使得由 \( X \mathbf{a} \) 所生成的预测值与实际观测值 \( \mathbf{y} \) 之间的欧几里得距离最小。换句话说，最小二乘解是将数据点投影到由矩阵 \( X \) 的列生成的子空间上的最优投影。

### 适用条件

- 当 \( X^T X \) 是非奇异矩阵（可逆矩阵）时，最小二乘解可以通过上述公式唯一确定。
- 当 \( X^T X \) 不可逆或行列式为零时，可以采用**广义逆矩阵**来求解。

### 总结

最小二乘解是一种通过最小化误差平方和来拟合线性模型的方法，常用于解决回归问题和数据拟合问题。通过对误差平方和求导，可以得出最优解，几何上它是寻找数据点在特征空间的最佳拟合。

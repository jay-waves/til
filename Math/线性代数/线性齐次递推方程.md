
## 数列通项的特征根

$$a_n+c_{1}a_{n-1}+c_{2}a_{n-2}+\cdots+c_{k}a_{n-k}=f(n)$$ 

对于数列 $\{a_{n}\}$, 常数 $c_{i}\not= 0$, 每一项由前 $k$ 项推导得出. 称为 $k$ 阶线性递推方程. 如斐波那契数列 $a_{n+1}=a_{n}+a_{n-1}$ 就是二阶齐次线性方程 $a_{n}-a_{n-1}-a_{n-2}=0$

对于齐次方程, 设数列通项形式为: $a_{n}=x^{n}, x\not=0$, 则递推公式化为:

$$F(x)=x^{n}+c_{1}x^{n-1}+\cdots+c_{k}x^{n-k}=0$$

即: $$F(x)=(x^{k}+c_{1}x^{k-1}+\cdots+c_{k})\cdot x^{n-k}=0, x\not=0$$

$F(x)$ 为一元 $k$ 次方程, 在复数域上有 $k$ 个根, 并且 $x\not=0$. 如果这些根互不相同, 由范德蒙德行列式可以证明这些根是线性无关的. 但若存在重根, 即形如:

$$F(x)=(x-\alpha)^{t}G(x)x^{n-k}=0$$

此时 $\alpha$ 为 $F(x)$ 的 $t$ 重根. 对 $F(x)$ 求导: 

$$F'(x)=(x-\alpha)^{t}(G(x)x^{n-k})'+t(x-\alpha)^{t-1}G(x)x^{n-k}$$

仍有 $F'(\alpha)=0$, 考虑原方程形式:

$$F'(x)=nx^{n-1}+c_{1}(n-1)x^{n-2}+\cdots+c_{k}(n-k)x^{n-k-1}=0$$

$$xF'(x)=nx^{n}+c_{1}(n-1)x^{n-1}+\cdots+c_{k}(n-k)x^{n-k}=0$$

可见 $n\alpha^{n}$ 是原方程的解[^1]. 同理 $(\alpha^{n},n\alpha^{n},\cdots,n^{t-1}\alpha^n)$ 也是方程的解.

[^1]: 其他系数形式也可以, 如 $A_n^m$ 也可以

称 $x^{k}+c_{1}x^{k-1}+\cdots+c_{k}=0$ 为该齐次线性递归方程的**特征方程**, 其 $k$ 个复根称为该方程的**特征根**. 特征根的线性组合就是齐次方程的通解.

对于非齐次方程, 其解系为齐次通解的线性组合加上非齐次特解. 若 $f(n)$ 是一个常数, 则使用 **不动点**技巧, 假设原数列是常数数列, 即 $a_{n}=a_{n-1}=\cdots=C$, 然后代入原递推方程解出 $C$ 的值. 类似求 $a_{n+1}=f(a_{n})$ 极限时, 令 $a_{n}=a_{n+1}$. 若 $f(n)$ 不是常数, 则根据其形式凑解, 比如 $f(n)=C_{1}q^{n}$, 则设特解为 $C_{2}q^{n}$.

### 例子1

$a_n = a_{n-1} + a_{n-2} - n$, 其中$a_1 = 5,  a_2 = 8$

改写成

$a_n - a_{n-1} - a_{n-2} = - n$

凑一个特解, 特解的形式应该是$a_n = C_1 n + C_2$, 代回原方程：

$C_1 n + C_2 - C_1 (n-1) - C_2 - C_1(n-2) - C_2 = -n$

$-C_1 n + (3C_1 - C_2) = -n$

因此

$C_1 = 1,  C_2 = 3$

验证一下, $a_n = n + 3$ 的确是原递推方程的解. 

再来求出通解, 去掉非齐次项代入一个等比数列, 特征方程是

$x^2 - x - 1 = 0$

特征根为

$x_1 = \frac{1 + \sqrt{5}}{2},  x_2 = \frac{1 - \sqrt{5}}{2}$

所以解的形式可以表示特征解的线性和再加上特解：

$a_n = C_3 \left(\frac{1 + \sqrt{5}}{2}\right)^n + C_4 \left(\frac{1 - \sqrt{5}}{2}\right)^n + n + 3$

代入最早的递推关系中, 得到

$\left\{\begin{array}{l}C_3 \left(\frac{1 + \sqrt{5}}{2}\right) + C_4 \left(\frac{1 - \sqrt{5}}{2}\right) = 1 \\ C_3 \left(\frac{1 + \sqrt{5}}{2}\right)^2 + C_4 \left(\frac{1 - \sqrt{5}}{2}\right)^2 = 3\end{array}\right.$.

得到$C_3 = C_4 = 1$, 因此

$a_n = \left(\frac{1 + \sqrt{5}}{2}\right)^n + \left(\frac{1 - \sqrt{5}}{2}\right)^n + n + 3$

### 例子2

有的时候, 递推方程一眼看上去根本不是线性的, 但可以经过变换变成线性递推方程, 比较经典的是分式的形式, 比如

$a_{n+1} = \frac{a_n - 1}{2a_n - 3}$ 

我们希望把它凑成

$\frac{1}{a_{n+1} - p} = \frac{k_1}{a_n - p} + k_2$ 的形式, 从而变成一个线性递推的方程. 整理得到

$a_{n+1} = \frac{a_n - p}{k_2 a_n - pk_2 + k_1} + p = \frac{(1+pk_2)a_n - p - p^2k_2 + k_1p}{k_2 a_n - pk_2 + k_1}$

比较系数得到

$\frac{1+pk_2}{k_2} = \frac{1}{2}$

$\frac{-pk_2 + k_1}{k_2} = -\frac{3}{2}$

$\frac{-p-p^2k_2 + k_1p}{k_2} = -\frac{1}{2}$


## 微分方程的特征根

解高阶常系数微分方程的思想类似: $$F(x)=y^{(n)}+a_{n-1}y^{(n-1)}+\cdots a_{1}y'+a_{0}y=0$$

## 参考

[利用特征根与不动点推导数列通项公式-知乎-灵剑的回答](https://www.zhihu.com/question/51662733/answer/126920544?utm_source=ZHShareTargetIDMore&utm_medium=social&utm_oi=1095759873433755648)

线性微分方程

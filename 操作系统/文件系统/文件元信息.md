## 文件信息

```sh
$ ls -al
-rwxr-xr-x 1 yjw yjw 16697 May 29 10:19 tmp
[类型,权限][链接数][拥有者][群组][文件大小][修改日期][文件名]
```

### 类型 

- file (f), 或用 `-` 表示.
- directory (d)
- symlink (l)
- executable (x)
- empty (e)
- socket (s)
- pipe (p) 
- char-dev (c): 字符设备
- block-dev (b): 块设备

### 权限

Linux 中权限以权限位形式出现, 如文件权限为可能是 `rwx rwx r--`, 第一个 `rwx` 为*属主*权限, 第二个 `rwx` 为*群组*权限, 第三个 `rwx` 为*访客*权限, 无权限用 `-` 占位.

对于目录而言, `x` 表示"可以进入目录", `w` 表示"有编辑权限". `rwx` 也分别对应数字 `421`, 权限可简写为三者之和. 如 `rw-` 对应 `3`.

用 `chmod` 修改文件权限, 推荐用数字模式 (1, 2, 4). 用 `umask` 修改文件默认权限, 推荐使用字符缩写 (u, g, o, a).

#### `s` 位

`chmod u+s ...` 指 setuid, 无论谁执行该文件, 程序都会自动以文件所有者的权限运行. 用于需要提供临时提权的程序. 

`chmod g+s ...` 指 setgid, 无论谁执行该文件, 都会以文件属组的权限运行. 设置在目录时, 目录下所有新文件都会继承此目录的组, 而非创建者的组.

此时程序权限如: `rws...`

#### `t` 位

也称粘滞位, 设置在目录上时, 即使多个用户都有对目录的写权限, 但只有文件的所有者或超级用户才能**删除或重命名**该目录.

此时权限如: `drwxrwx--T`

### 时间

文件有三种时间:
1. status-time (ctime): 状态, 权限, 属性 更改时会更新此时间. 不可移植(复制)
2. access-time (atime): 该文件内容被读取或获取时会更新此时间
3. modification-time (mtime): 文件内容变更时, 会更改此时间. 此时间为默认时间

查询命令如 `ls -l --time=atime`

## 工具

### `stat`

`stat` 查看文件的详细系统信息:

```bash
$ stat
stat book
  File: book
  Size: 0               Blocks: 24         IO Block: 65536  directory
Device: 4734f200h/1194652160d   Inode: 281474976711798  Links: 1
Access: (0755/drwxr-xr-x)  Uid: (197609/   yjw)   Gid: (197121/ UNKNOWN)
Access: 2024-11-02 10:53:27.786891500 +0800
Modify: 2024-10-30 22:35:28.987962100 +0800
Change: 2024-10-30 22:35:28.987962100 +0800
 Birth: 2021-08-08 19:00:29.889082700 +0800
```

### `file`

`file` 查看文件类型及格式, 如 ascii 编码文本, JPEG 等各类型图像, ELF 执行文件等.

```bash
$ file index.html
 index.html: HTML document, ASCII text
```

更现代的工具: binwalk.

### `chattr`

`chattr` 修改文件属性, 比文件权限更底层.

```bash
# 保护文件不被意外删除, 可用不可修改标记:
sudo chattr +i /my/critical/file
```
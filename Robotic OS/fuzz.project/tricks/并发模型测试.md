ros2 系统混合了 channel-based 和 process/thread-based 并发模型的特点. 即各节点分别是独立进程, 进程间通过 ROS Channel 机制来通信; 各进程中有多个线程处理不同回调函数和功能, 通过共享内存来互相通信.

可能出现的 bug 有:
- 死锁 Deadlock
- 数据竞争 Data Race: write-write, write-read, read-dirty
- Buffer Overflow: 对通信缓存管理不善 (如map_size)
- Use-After-Free (UAF)
- Null-Pointer Dereference: like double free

并发模型中, 多线程多进程间通信方式有共享内存和消息通道两种方式, 基于共享内存, 有xxx; 基于消息通道, 有: socket, 消息队列, 管道通道等方式.
在并发模型中，多线程和多进程之间的通信是实现数据共享、任务协调和资源管理的关键。这些通信方式大体上可以分为两种主要类型：共享内存和消息通道。

### 基于共享内存的通信方式

基于共享内存的通信方式允许多个进程或线程直接访问同一块内存区域，实现数据的快速交换和更新。这种方法的优点是通信速度快，因为它避免了数据的复制操作。然而，它也需要更细致的同步控制来避免并发访问的冲突，如使用互斥锁（Mutexes）、信号量（Semaphores）、读写锁（Read-Write Locks）和条件变量（Condition Variables）等机制来协调对共享数据的访问。

### 基于消息通道的通信方式

基于消息通道的通信方式通过创建一个中介的通信通道，使得进程或线程可以相互发送和接收消息。这种方式的通信模型更为明确，每个通信操作都是通过明确的消息传递完成的，从而简化了进程间的数据同步和管理。

1. **Socket通信：** Socket 是一种网络编程的基础，它允许不同主机上的进程通过网络进行数据交换。Socket 通信分为基于流的 TCP 通信和基于数据报的 UDP 通信，适用于跨网络的进程间通信（IPC）。
    
2. **消息队列（Message Queues）：** 消息队列提供了一种跨进程发送和接收消息的机制。与直接的共享内存或Socket通信相比，消息队列通过队列化消息来简化通信过程，支持异步通信和解耦合的进程间交互。
    
3. **管道通道（Pipes）：** 管道是UNIX和类UNIX系统中用于进程间通信的原始形式之一。管道可以是匿名的，用于父子进程间的通信；或者是命名管道（FIFOs），它允许不相关的进程间进行双向通信。
## GPIO

GPIO (通用可编程 I/O), 由一组控制寄存器和一组数据寄存器控制.
- 当引脚设置为输出时, 
	- 向数据寄存器写入 1, 引脚产生高电平.
	- 向数据寄存器写入 0, 引脚产生低电平.
- 当引脚设置为输入时, 读取数据寄存器的对应位, 以获取引脚电平.

## 电平标准

电平高低通常代表数字 0 和 1, 但是不同技术下定义的电平标准不同, 其功耗 / 速度 / 稳定性 等也有区别.

CMOS (Complementary Metal-Oxide-Semiconductor) 电平: CMOS 是电压控制元件.
- 高电平: 接近 Vdd (电源电平, 常见 1.8V, 2.5V, 3.3V, 5V)
- 低电平: 接近 0V
- 静态时几乎不消耗电流. 是现代数字电路最常见技术.

静电放电 (ESD) 会短暂产生高电压. CMOS 主要由 [MOSFET](../数字电路/门电路.md) 构成, 其栅极的氧化层很薄, 
容易被高电压击穿, 造成损坏. 

TTL (Transisitor-Transisitor Logic): TTL 是电流控制元件, 由 [BJT](../数字电路/门电路.md) 组成. CMOS 的功耗比 TTL 小, 抗干扰性强, 但是比较贵.
- 高电平: 2.4V 至 5V
- 低电平: 0V 至 0.8V
- 通常使用 5V 电源, 电压范围窄. 消耗更大电流, 但电平切换速度更快.

RS-232C 串口协议的电平: 全双工, 至少有 RT,TX,GND 三条线.
- 高电平: -3V 至 -15V. 通常是 -12V
- 低电平: 3V 至 15V. 通常是 +12V.
- 由于使用正负电压, 使得信号能在较长距离传输, 不必担心衰减 (从高电平变为零).

## 串口

RS-232C 是流行的串行数据接口标准 (EIA, 1969), 负责连接 DTE (数据终端设备) 和 DCE (数据通信设备):
- RTS (请求发送流控制): DTE 请求 DCE 发送数据.
- CTS (清除发送流控制): DCE 准备好接受 DTE 发送的数据, 是对 RTS 的响应信号.
- RxD (数据接受): DTE 通过 RxD 接受从 DCE 发送来的串行数据.
- TxD (数据发送): DTE 通过 TxD 将串行数据发送到 DCE.
- DSR (数据终端就绪流控制): 有效 (ON), 表示 DCE 可以使用.
- DTR (数据设置就绪流控制): 有效 (ON), 表示 DTE 可以使用.
- DCD (数据载波检测, 也叫 RLSD): 本地 DCE 接受到对方 DCE 设备送来的载波信号, 使 DCD 有效, 通知 DTE 准备接受, 并且由 DCE 将接受到的载波信号解调为数字信号, 经 RxD 发送给 DTE.
- Ringing-RI (振铃指示): 当调制解调器收到交换台送来的振铃呼叫时, 使该信号有效 (ON), 通知终端已被呼叫.
- SG (信号地)

![引用 2, 图 2.9|600](../../attach/RS232C_IO.avif)

CPU 是并行的, 一次处理 64 位数据. 串口则是串行的, 一次处理一位. CPU 向串口发送数据时, 先通过 *UART (通用异步收发器)* 将并行数据转换为串行数据, 并按 RS-232C 协议的格式进行编码. 接着, 将 CMOS/TTL 电平转化为 RS-232C 电平.


## I2C 

## SPI 

SPI (Serial Peripheral Interface, 串行外设接口) 是同步串行接口. 主控作为 SPI 的主机, 外设作为 SPI 的从机.

- 串行时钟线 (SCLK)
- 主机输入/从机输出数据线 (MISO)
- 主机输出/从机输入数据线 (MOSI)
- 低电平有效的从机选择线 (SS)

当主机想和外设 1 通信时, 会将 SS1 置低电平.

![引用 2, 图 2.9|400](../../attach/SPI_IO.avif)

通过配置 输出串行同步时钟极性 (CPOL) 和相位 (CPHA), SPI 可以配置适应不同外设的频率, 采样时刻. 
- CPOL=0, 串行同步时钟的空闲状态为低电平
- CPOL=0, 串行同步时钟的空闲状态为高电平
- CPHA=0, 串行同步时钟的第一个跳变沿 (上升或下降) 数据被采样.
- CPHA=1, 串行同步时钟的第二个跳变沿 (上升或下降) 数据被采样.

## USB

USB (通用串行总线) 的目的是统一不同外设种类的插槽类型. 有速率高, 易扩展, 即插即用和热插拔 等特点.

不同代 USB 的差别:
- USB1.1 有全速 (12Mb/s) 和低速模式 (1.5Mb/s)
- USB2.0: 480 Mb/s, 半双工. 4 线.
- USB3.0: 5Gb/s, 约 640MB/s, 全双工. 8 线.

电路板挂接外部 USB 设备, 需要提供 USB 主机控制器; 若作为 USB 设备, 则需要提供 USB 设备设配器. 
在 USB 设备组成的设备拓扑中, 有不同的数据传输方式:
1. 控制传输方式 (Control): 双向传输, 数据量小.
2. 同步传输方式 (Isochronous): 用于即时传输, 提供了确定的带宽和间隔时间. 如语音业务.
3. 中断传输方式 (Interrupt): 中断是单向的, 定时由 USB 设备向主机输入. 如: 键盘, 鼠标.
4. 批量传输方式 (Bulk): 传输批量数据组成的数据流. 如: 打印机, 扫描仪.

USB 总是支持热插拔 (Hot-Plugging) 和 即插即用 (Plug-and-Play), 即不需要重启设备就能识别到外设的挂载与接入. 有几个技术:
1. USB 引脚 (VBUS, GND, D+, D-) 中, 电源引脚比数据引脚更长. 插入时, 电源先连接, 数据后链接.
2. 插入设备后, 主机通过 USB 协议进行重新枚举, 接着分配地址和加载驱动.

## 以太网接口

IEEE 802.3 定义了以太网接口 (数据链路层). 以太网接口由 MAC (以太网媒体接入控制器) 和 PHY (物理接口收发器), 两者之间使用 MII (媒体独立接口) 连接, 包含一个双工数据接口和一个管理接口.

数据接口包含接受和发送两个独立信道, 每个信道有独立的数据 / 时钟 / 控制信号; 管理接口包含一个时钟信号和一个数据信号. 因此 MII 接口总共包含 16 个信号. 通常网卡会集成 MAC 和 PHY.

![|600](../../attach/ethernet_io.avif)

## PCI

PCI (外围部件互连) 是 Intel 1991 年推出的总线标准, 各个设备皆并行连接在总线上.  PCI-E (Express) 是新一代 PCI, 设备间不再共享总线资源, 而是有自己的专用连接, 串行传输数据.

## SD

SD (Secure Digital) 是 Flash 存储卡的设计标准. SDIO 则是 SD 标准上外设接口标准, 

eMMC (Embedded Multi Media Card) 是移动设备本地存储标准, 封装了 NAND Flash, 闪存控制芯片等.

## 硬件时序

> 详见：[正则表达式的先行断言(lookahead)和后行断言(lookbehind)  菜鸟教程](https://www.runoob.com/w3cnote/reg-lookahead-lookbehind.html)

## 基础
正则表达式的先行断言和后行断言一共有 4 种形式：

1.   (?=pattern) 
- 零宽正向先行断言 (zero-width positive lookahead assertion)
- 代表字符串中的一个位置，紧接该位置之后的字符序列能够匹配 pattern。
2.   (?!pattern) 
- 零宽负向先行断言 (zero-width negative lookahead assertion)
- 代表字符串中的一个位置，紧接该位置之后的字符序列不能匹配 pattern。。
3.  (?<=pattern) 
- 零宽正向后行断言 (zero-width positive lookbehind assertion)
- 代表字符串中的一个位置，紧接该位置之前的字符序列能够匹配 pattern。
4.  (?<!pattern) 
- 零宽负向后行断言 (zero-width negative lookbehind assertion)
- 代表字符串中的一个位置，紧接该位置之前的字符序列不能匹配 pattern。

这里面的 **pattern** 是一个正则表达式。

对于这 4 个断言的理解，可以从两个方面入手：

-   **1、关于先行(lookahead)和后行(lookbehind)：**正则表达式引擎在执行字符串和表达式匹配时，会从头到尾（从前到后）连续扫描字符串中的字符，设想有一个扫描指针指向字符边界处并随匹配过程移动。先行断言，是当扫描指针位于某处时，引擎会尝试匹配指针还未扫过的字符，先于指针到达该字符，故称为先行。后行断言，引擎会尝试匹配指针已扫过的字符，后于指针到达该字符，故称为后行。
    
-   **2、关于正向(positive)和负向(negative)：**正向就表示匹配括号中的表达式，负向表示不匹配。
    

对这 4 个断言形式的记忆：

-   **1、先行和后行：**后行断言 (?<=pattern)、(?<!pattern) 中，有个小于号，同时也是箭头，对于自左至右的文本方向，这个箭头是指向后的，这也比较符合我们的习惯。把小于号去掉，就是先行断言。
    
-   **2、正向和负向：**不等于 (!=)、逻辑非 **(!)** 都是用 !号来表示，所以有 ! 号的形式表示不匹配、负向；将 ! 号换成 \= 号，就表示匹配、正向。

如同 ^ 代表开头，$ 代表结尾，\\b 代表单词边界一样，先行断言和后行断言也有类似的作用，它们只匹配某些位置，在匹配过程中，不占用字符，所以被称为**"零宽"**。所谓位置，是指字符串中(每行)第一个字符的左边、最后一个字符的右边以及相邻字符的中间（假设文字方向是头左尾右）。



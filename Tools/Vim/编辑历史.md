## 跳转历史

Vim 也自动记录100次**跳转历史**, 每个窗口的跳转记录是独立的.

| 历史     | 列出所有条目 | 跳转到上一历史(的位置) | 跳转到下一历史 |
| -------- | ------------ | -------------- | -------------- |
| 跳转历史 | `:jumps`     | `[cnt]<c-o>`   | `[cnt]<c-i>`   |
| 变更历史 | `:changes`   | `[cnt]g;`      | `[cnt]g,`               |

> 帮助见 `:h jumplist`, `:h changelist`, 跳转历史也被记录到[标注](标注.md)中


## 变更历史

Vim 自动记录100次**变更历史**, 变更以行为单位, 即行内改动历史会被合并为一个历史.
- `u` 撤销内容变更
- `<c-r>` 来恢复变更

Vim 采用**树**结构来存储历史, 而不是**队列**结构. 每个树节点皆记录内容及改动事件, 当撤销操作后又输入新内容, 相当于建立了新树分支.

考虑下列操作

```vim
ifoo<esc>
obar<esc>
obaz<esc>
u
oquux<exc>
```

此时显示的文本为:

```
foo
bar
quux
```

此时 Vim 存储的历史结构为:

```
	 foo(1)
  	 / 
	bar(2)
   /    \
baz(3)  quux(4)
```

- 按分支遍历历史: `u`, `<c-r>`, 此时从 `quux` 回退到 `bar`.
- 按时间遍历历史: `g-`, `g+`, 此时从 `quux` 回退到 `baz`.

| 命令                       | 效果                                                                                                                                                          |
| ---------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `[cnt]u` 或 `:undo [cnt]`      | 回退到 `[cnt]` 次改动之前                                                                                                                                       |
| `<c-r>` 或 `:redo`  | 重做改动                                                                                                                                             |
| `U`                                | 回退至最新的改动                                                                                                                                                  |
| `[cnt]g-` 或 `:earlier [cnt]?` | 按时间回退, 如 `:earlier 2d` 回退至两天前, `:earlier 1f` 回退到最近一次文件保存. |
| `g+` 或 `:later`   |                                                                                                                                              |

**值得注意, 内容变更记录在内存, 退出时即清空.** 持久化变更, 请参考[文件备份](文件备份.md).

> 更多帮助: `:h undo.txt`, `:h usr_32.txt`



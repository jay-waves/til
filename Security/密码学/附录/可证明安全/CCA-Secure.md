### Malleability

A scheme is **malleable** means it is possible to modify a ciphertext and thereby cuase a predictable change to plaintext.

## Private Key Enc

Formally, CCA give the adversary access to a decryption oracle $\text{Dec}_k(\cdot)$ in addition to an encryption oracle $\text{Enc}_k(\cdot)$. 

Consider the following experiment for any private-key encryption scheme $\Pi = (\text{Gen}, \text{Enc}, \text{Dec})$, adversary $A$, and value $n$ for the security parameter.

**The CCA indistinguishability experiment** $\text{Priv}^{cca}_{A,\Pi}(n)$:
- A key $k$ is generated by running $\text{Gen}(1^n)$.
- $\mathcal{A}$ is given input $1^n$ and oracle access to $\text{Enc}_k(\cdot)$ and $\text{Dec}_k(\cdot)$. It outputs a pair of equal-length messages $m_0, m_1$.
- A uniform bit $b \in \{0,1\}$ is chosen, and then a challenge ciphertext $c \leftarrow \text{Enc}_k(m_b)$ is computed and given to $A$.
- The adversary $\mathcal{A}$ continues to have oracle access to $\text{Enc}_k(\cdot)$ and $\text{Dec}_k(\cdot)$ but is not allowed to query the latter on the challenge ciphertext itself. Eventually, $A$ outputs a bit $b'$.
- The output of $\text{Priv}^{cca}_{A,\Pi}(n)$ is $1$ if $b' = b$, and $0$ otherwise.

### Security

A private-key encryption scheme $\Pi$ has indistinguishable encryptions under a chosen-ciphertext attack, or is CCA-secure, if for all probabilistic polynomial-time adversaries $\mathcal{A}$ there is a negligible function $\text{negl}$ such that: $$\Pr[\text{Priv}^{cca}_{A,\Pi}(n) = 1] \leq \frac{1}{2} + \text{negl}(n),$$ where the probability is taken over all randomness used in the experiment.

If a scheme has indistinguishable encryptions under a chosen-ciphertext attack then it is infeasibly probable multiple encryptions under a chosen-ciphertext attack, defined appropriately.

CCA-security implies non-malleability.

## Public Key Enc

Given a public-key encryption scheme $\Pi$ and an adversary $\mathcal{A}$, consider the following experiment:

**The CCA indistinguishability experiment** $\text{PubK}^{\text{cca}}_{A,\Pi}(n)$:
1. $\text{Gen}(1^n)$ is run to obtain keys $(pk, sk)$.
2. The adversary $A$ is given $pk$ and access to a decryption oracle $\text{Dec}_{sk}(\cdot)$. It outputs a pair of messages $m_0, m_1 \in M_{pk}$ of the same length.
3. A uniform bit $b \in \{0,1\}$ is chosen, and then a ciphertext $c \leftarrow \text{Enc}_{pk}(m_b)$ is computed and given to $A$.
4. $A$ continues to interact with the decryption oracle, but may not request a decryption of $c$ itself. Finally, $A$ outputs a bit $b'$.
5. $\text{PubK}^{\text{cca}}_{A,\Pi}(n)=1$ if $b' = b$, and $0$ otherwise.

A public-key encryption scheme $\Pi = (\text{Gen}, \text{Enc}, \text{Dec})$ has indistinguishable encryptions under CCA if for all PPT adversaries $\mathcal{A}$ there exists a negligible function $\text{negl}$ such that $$\Pr[\text{PubK}^{\text{cca}}_{A,\Pi}(n) = 1] \leq \frac{1}{2} + \text{negl}(n)$$

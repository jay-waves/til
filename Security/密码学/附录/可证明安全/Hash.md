## Hash

A hash function (with output length $\ell(n)$) is a pair of [probabilistic polynomial-time algorithms](Private-Key%20Encryption.md) $\mathcal{H}=(\text{Gen}, H)$ satisfying the following:
- Gen is a probabilistic algorithm that takes as input a security parameter $1^n$ and outputs a key $s$. We assume: $n$ is implicit in $s$.
- $H$ is a deterministic algorithm that takes as input a key $s$ and a string $x \in \{0,1\}^*$ and outputs a string $H^s(x) \in \{0,1\}^{\ell(n)}$ (where $n$ is the value of the security parameter implicit in $s$).

If $H^s$ is defined only for inputs $x$ of length $\ell'(n) > \ell(n)$, then we say that $(\text{Gen}, H)$ is a fixed-length hash function for inputs of length $\ell'(n)$. In this case, we also call $H$ a compression function.

### Collision Security[^1]

**The collision-finding experiment** $\text{Hash-coll}_{A,H}(n)$:
- A key $s$ is generated by running $\text{Gen}(1^n)$.
- The adversary $A$ is given $s$, and outputs $x, x'$. (If $H$ is a fixed-length hash function for inputs of length $\ell'(n)$, then we require $x, x' \in \{0,1\}^{\ell'(n)}$.)
-  $\text{Hash-coll}_{A,H}(n)=1$ if and only if $x \neq x'$ and $H^s(x) = H^s(x')$. In such a case we say that $A$ has found a collision.

![|400](../../../../attach/Pasted%20image%2020231228210124.png)

**Collision resistance** states that no efficient adversary can find a collision in the above experiment except with negligible probability: $$Pr[\mathsf{Hash-coll}_{\mathcal{A,H}}(n)=1]\leq \mathsf{negl}(n)$$

#### other weak notions:

- **Second-preimage resistance**: hash is second-preimage resistant if given $s$ and a uniform $x$ it is infeasible for a PPT adversary to find $x' \neq x$ such that $H^s(x') = H^s(x)$.
- **Preimage resistance**: hash is preimage resistant if given $s$ and $y = H^s(x)$ for a uniform $x$, it is infeasible for a PPT adversary to find a value $x'$ (whether equal to $x$ or not) with $H^s(x') = y$.

Any hash function that is collision resistant is also second-preimage resistant. It is also true that if a hash function is second-preimage resistant then it is preimage resistant.

> see [消息摘要](../../消息摘要/消息摘要.md) for details

## ROM

the Random Oracle Model:
- If x has not been queried to H, then the value of $H(x)$ is **uniform**.
- Extractability: If $\mathcal{A}$ queries x to $H$, the reduction can **see this query** and learn x.
- Programmability: The reduction can **set** value of $H(x)$ to a value of tis choice, as long as this value is correctly distributed, i.e. uniform.

How to design protocols in ROM?
1. Find a formal security definition for the problem in ROM.
2. Devise an efficient protocol that solves the problem.
3. Prove that the protocol satisfies the security definition.
4. Instantiate RO with cryptographic hash functions, e.g,
SHA3

[^1]: P169, *Introduction to Modern Cryptography* by Jonathan Katz
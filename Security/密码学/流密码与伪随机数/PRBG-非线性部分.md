
## 伪随机数发生器的非线性部分

线性伪随机数发生器产生的密钥流一定是周期的. 加上非线性部分以提高密钥流的线性复杂度.

称序列的线性复杂度为生成该序列的最短LFSR级数, 设序列周期为 $T$, 满足 $2^{n-1}-1< T\leq 2^{n}-1$, 则该序列的线性复杂度为 $n$.

### Geffe 序列生成器

Geffe 序列生成器接受三个 LFSR 的输入，其输入分别为序列 $\set{a_{n}^{(1)}}, \set{a_{n}^{(2)}}, \set{a_{n}^{(3)}}$, 输出序列为 $\set{b_{k}}$, 表示为:

| $a_{k}^{(2)}$ | $b_{k}$     |
| ----------- | ----------- |
| 0           | $a_{k}^{(3)}$ |
| 1           | $a_{k}^{(1)}$            |
  
若 $\set{a_{n}^{(1)}}, \set{a_{n}^{(2)}}, \set{a_{n}^{(3)}}$ 的周期分别为 $2^{n_1}-1$, $2^{n_2}-1$ 和 $2^{n_3}-1$ 且 $n_1, n_2, n_3$ 两两互素，则 $\set{b_k}$ 的周期为 $(2^{n_{1}}-1),(2^{n_{2}}-1),(2^{n_3}-1)$, 线性复杂度为 $(n_1+n_3)n_2+n_3$

### JK触发器

JK 触发器接受两个 LFSR 的输入，其输入分别为序列 $\set{a_n^{(1)}}, \set{a_n^{(2)}}$.

其输出序列 $\set{b_k}$ 可以表示为

| $a_k^{(1)}$ | $a_k^{(2)}$ | $b_k$     |
| ----------- | ----------- | --------- |
| 0           | 0           | $b_{k-1}$ |
| 0           | 1           | 0         |
| 1           | 0           | 0         |
| 1           | 1           | $\overline{b_{k-1}}$          |

若 $\set{a_n^{(1)}}$ 和 $\set{a_n^{(2)}}$ 的周期分别为 $2^n-1$ 和 $2^m-1$ 且 $m, n$ 互素，$a_0^{(1)}+a_0^{(2)}=1$, 则 $\set{b_k}$ 的周期为 $(2^n-1)(2^m-1)$

### 钟控序列生成器

钟控序列接受两个LFSR的输入，其输入分别为序列 $\set{a_n^{(1)}}, \set{a_n^{(2)}}$.
前一个序列控制后一个序列的时钟周期 $n_k$.

其输出序列$\brace{b_k}$可以表示为

| $a_k^{(1)}$ | $n_k$     | $b_{k}$           |
| ----------- | --------- | ----------------- |
| 0           | $n_{k-1}$ | $a_{n_{k}}^{(2)}$ |
| 1           |    $n_{k-1}+1$       |    $a_{n_k}^{(2)}$               |

若 $\set{a_n^{(1)}}$ 和 $\brace{a_n^{(2)}}$ 的周期分别为 $p_1$ 和 $p_2$,
且记 $w=\sum_{i=0}^{p_1-1}a_i^{(1)}$,
则 $\set{b_k}$ 的周期为 $\frac{p_1p_2}{\gcd(w, p_2)}$.
若 $p_1=2^m-1, p_2=2^n-1$, 则其线性复杂度为 $n(2^m-1)$.

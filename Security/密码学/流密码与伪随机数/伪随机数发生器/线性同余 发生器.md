## 线性同余伪随机数发生器

随机序列 $\{X_{n}\}$ 迭代如: $X_{n+1}=aX_{n}+c\pmod m$

定义PRNG发生器 $f$为: $f(X_{0})=(z_{1},\ z_{2},\ \dots,\ z_{n})$, 其中 $z_{n}=X_{n}\pmod 2$.

评判线性同余发生器标准:
- 迭代函数应该是全周期的, 同时周期m应尽量大
- 产生的序列较随机

广泛采用 $X_{n+1}=aX_{n}\pmod{2^{31}-1}$, 其中 $m=2^{31}-1$ 为素数, $a=7^{8}=16807$ 是 $m$ 的本原根. 因为 $X_{n+1}=aX_{n}=a^{n}X_{0}$, 所以当 $a$ 为 $m$ 本原根时, 迭代函数 $\{X_{i}\}$ 是全周期的. 该法也方便32位机实现.

##### 安全性

教科书式线性同余发生器着实不太安全, 如果敌手知道连续的 $X_{1},\ X_{2},\ X_{3},\ X_{4}$, 则可以通过以下方程组解出参数 $a,c,m$, 一旦参数泄露, 此后所有 $X_{i}$ 都会泄露.
$$\begin{align}
X_{2}\equiv a\cdot X_{1}+c\pmod{m} \\
X_{3}\equiv a\cdot X_{2}+c\pmod{m} \\
X_{4}\equiv a\cdot X_{3}+c\pmod{m}
\end{align}$$

**定理**: 线性同余算法达到整周期的充要条件为:
- $gcd(c,\ m)=1$
- 对于所有满足 $p\ \vert\ m$ 的素数 $p$, 有 $a\equiv 1\pmod{p}$
- 若 $4\ \vert\ m$, 则 $a\equiv 1\pmod{4}$

由此, 可取 $m=2^{r}$, $a=2^{i}+1$, $c=1$, 其中 $i<r$.

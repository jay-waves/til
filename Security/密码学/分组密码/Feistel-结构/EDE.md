弱 $E_{k_{1}}(E_{k_{2}}(x))=E_{k_{3}}(x)$, 则称密码算法 $E$ 是闭合的. DES算法的 $\{E_{k}\}$ 被证明不是一个群, 即不闭合, 所以多重DES可以增强一定安全性.

### EDE

将DES加解密组合起来, 此方案仍有足够安全性. 密钥为 $k_{1}\Vert k_{2}$, 长度为 `112 bits`

加密: $y=E_{k_{1}}[\ D_{k_{2}}[\ E_{k_{1}}[\ x\ ]]]$

解密: $x=D_{k_{1}}[\ E_{k_{2}}[\ D_{k_{1}}[\ y\ ]]]$

### 中间相遇攻击

==二重/三重DES加密安全性不如两倍/三倍密钥量==, 因为存在**中间相遇攻击**. 其基本思想是, 以二重DES为例, 若 $(x_{i},y_{i})$ 满足 $y_{i}=E_{k_{2}}[\ E_{k_{1}}[\ x_{i}\ ]\ ]$, 则 $z=E_{k_{1}}[x_{i}]=D_{k_{2}}[y_{i}]$.

假设敌手有[**已知明文攻击**](../../概念与标准/安全模型.md)能力, 攻击步骤如下:
- 穷举 $k$ 所有 $2^{56}$ 个可能值, 得到 $z=E_{k}(x_{1})$ 全部存储表中
- 穷举 $k$ 所有 $2^{56}$ 个可能值, 得到 $D_{k}(y_{1})$ , 在表中查找是否有匹配的值. 确定 $k_{1}$ 和 $k_{2}$
- 取另一对 $(x_{2}, y_{2})$, 验证 $k_{1}$ 和 $k_{2}$ 是否正确.

$k_{1}k_{2}$ 密钥空间为 $2^{112}$, 平均有 $\frac{2^{112}}{2^{64}}=2^{48}$ 个密钥能产生固定 $(x,y)$. (前提是DES映射足够分散) 使用另一组 $(x_{2},y_{2})$ 来验证, 使虚报率降低至 $\frac{2^{48}}{2^{64}}=2^{-16}$.

该攻击空间复杂度为 $2^{56}\times 8$ 字节, 实验次数为 $2\times 2^{56}=2^{57}$, 当然查找也比较耗时: 单次 $\log(2^{56})=56$. 因此, 二重DES远不如双倍密钥量的安全强度, 三重DES同理, 反复加密带来的安全性提升不是指数级的.

另外, 多重DES解密, 本质就是在增加Feistel轮数.
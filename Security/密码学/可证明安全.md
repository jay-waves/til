Principles of Modern Cryptography:
1. Foraml Definitions
2. Precise Assumptions
3. Proofs of Security

## Computational Security

1. Security is only guaranteed against efficient adversaries that run for some feasible amount of time. 
2. Adversaries can potentially succeed (i.e., security can potentially fail) with some very small probability.

two approaches to define the above relaxations precisely:

### the Concrete Approach

*A scheme is $(t, \epsilon)-\mathsf{secure}$ if any adversary running for the time at most $t$ succeeds in breaking the scheme with probability at most $\epsilon$.*

### the Asymptotic Approach

*A scheme is **Secure** if any PPT (probablistic polynomial time) adversary succeeds in breaking the scheme with at most negligible probability.*

Given **security parameter n**, one can view n as corresponding to the length of the key. Also, we can view *running time of the adversary, as well as its success probability* as functions of n.
- PPT adversary: there is some polynomial $p$ such that the adversary runs for time at most $p(n)$ when the security parameter is n.
- negligible: probability smaller than any inverse polynomial in n. *iff for every polynomial p, there is a N such that for all $n>N$ it holds that $f(n)<\frac{1}{p(n)}$*. In other words, for all constants c, there is N such that for all $n>N$ it holds that $f(n)<n^{-c}$.

## Perfect Secrecy

- adversary knows the probability distribution of $M$
- adversary knows the encryption scheme
- adversary can *eavesdrop* the ciphertext (ciphertext-only attack, known-plaintext attack, KPA)

Perfect Secrecy is that **the [posteriori probability](../../Math/概率与随机/贝叶斯定理.md) that some message $m\in M$ was sent, conditioned on the ciphertext that was observed, should be no different from the a [priori probability](../../Math/概率与随机/贝叶斯定理.md#贝叶斯定理) that $m$ would be sent.**

#### Def. [^1]

[^1]: For an explanation of the abbreviated form, see [Math/ReadMe](Math/ReadMe.md#数学证明)

*An encryption scheme $(Gen, Enc, Dec)$ with message space $\mathcal{M}$ is perfectly secret if:*

*for every probability distribution for $\mathcal{M}$, every message $m\in \mathcal{M}$, and every ciphertext $c\in \mathcal{C}$ for which $\mathrm{Pr}[\mathcal{C}= c] > 0$ (not-zero probability):* $$\mathrm{Pr}[\mathcal{M} = m\ \vert\ \mathcal{C} = c] = \mathrm{Pr}[\mathcal{M} = m]$$

**Equivalent Definition:**

$$\mathrm{Pr}[\mathcal{C}=c\vert \mathcal{M}=m]=\mathrm{Pr}[\mathcal{C}=c]$$

#### Lem. Perfect Secret

*An encryption scheme $\mathrm{(Gen, Enc, Dec)}$ with message space $\mathcal{M}$ is perfectly secret if and only if $$Pr[\mathrm{Enc}_{K}(m)=c]=Pr[\mathrm{Enc}_{K}(m')=c]$$ holds for every $m,\ m'\in\mathcal{M}$ and every $c\in \mathcal{C}$, where $\mathrm{Pr}[\mathrm{Enc}_{K}(m)=c]\equiv \mathrm{Pr}[\mathcal{C}=c\vert \mathcal{M}=m]$.*

### One-Time Pad

Fix an integer $\lambda> 0$. The message space $\mathcal{M}$, key space $\mathcal{K}$, and ciphertext space $\mathcal{C}$ are all equal to $\{0, 1\}^\lambda$

- **Gen**: the key-generation algorithm chooses a key from $\mathcal{K}=\{0,1\}^\lambda$ according to the uniform distribution. (i.e. each of the $2^{\lambda}$ strings in the space is chosen as the key with probability exactly $2^{-\lambda}$ ) $$k=\mathrm{Gen(\mathcal{K})}$$

- **Enc**: given a key $k\in\mathcal{K}=\{0,1\}^\lambda$ and a message $m\in\{0,1\}^\lambda$, the encryption algorithm outputs the ciphertext: $$c:=k\oplus m$$

- **Dec**: given a key $k\in\mathcal{K}=\{0,1\}^\lambda$ and a ciphertext $c\in\{0,1\}^\lambda$ , the decryption algorithm outputs the message: $$m:=k\oplus c$$

#### Thm.

Shannon pointed out that a Ont-Time Pad is **Unconditionally Secure**,

iff *$(Gen, Enc, Dec)$ is a  prefectly secret encryption scheme,*

iff *$(Gen, Enc, Dec)$ is an encryption scheme with message spcae $\mathcal{M}$ and key space $\mathcal{K}$, that $\vert \mathcal{K}\vert\ge \vert \mathcal{M}\vert$.*

**Proof:**

Assume $\vert \mathcal{K}\vert<\vert \mathcal{M}\vert$, Let $\mathcal{M}(c)$ be the set of all possible messages that are decryptions of $c$. that is $$\mathcal{M}(c)\overset{def}{=}\{m\ \vert\ m=\mathrm{Dec}_{k}(c),\quad\text{for some }k\in\mathcal{K}\}$$ Clearly $\vert\mathcal{M}(c)\vert\ \leq\ \vert\mathcal{K}\vert$ ($\mathrm{Dec}$ is deterministic). If  $\vert \mathcal{K}\vert<\vert \mathcal{M}\vert$, there is some $m'\in\mathcal{M}$ such that $m'\not\in \mathcal{M}(c)$. But then:$$Pr[M=m'\vert C=c]=0\neq Pr[M= m']$$

$\blacksquare$

## Perfect Indistinguishable

### EVA-Secure[^2]

[^2]: EVA: eavesdrop. PriKE: Private Key Encryption, Symmetric Encryption. PubKE: Public Key Encryption, Asymmetric Encryption.

**The adversarial indistinguishability experiment $\text{PrivK}^{eav}_{\mathcal{A}, \Pi}(n)$:**

1. The adversary $\mathcal{A}$ is given input $1^n$, and outputs a pair of messages $m_{0}, m_{1}$, with $\vert m_{0}\vert =\vert m_{1}\vert$
2. A key k is generated by running $\textbf{Gen}(1^{n})$, and an uniform bit $b\in \{0, 1\}$ is chosen. Ciphertext $c\leftarrow \textbf{Enc}_{k}(m_{b})$ is computed and given to $\mathcal{A}$. We refer to c as the **challenge ciphertext**.
3. $\mathcal{A}$ outputs a bit b'.
4. $\mathsf{PrivK}^{eav}_{\mathcal{A}, \Pi}(n)=1$ if $b'=b$, and 0 otherwise.

$$\begin{align}
&Pr[\mathsf{PrivK}^{eav}_{\mathcal{A}, \Pi}(n)=1] \\
&=\frac{1}{2}\cdot Pr[\mathcal{A}(m_{0 })=0]+\frac{1}{2}\cdot Pr[\mathcal{A}(m_{1})=1] \\
&=\frac{1}{2} - \frac{1}{2}\cdot P[\mathcal{A} (m_{0 })=1]+\frac{1}{2}\cdot Pr[\mathcal{A}(m_{1})=1]
\end{align}$$

#### Def. Indistinguishablity

A private-key encryption scheme $\Pi = (Gen, Enc, Dec)$ has **indistinguishable** (IND) encryptions in the presence of as eavesdropper, or is **EAV-secure**, if for all probablistic polynomial-time (PPT) adversaries $\mathcal{A}$ there is a negligaible funciton **negl** such that, for all n(security parameter), $$Pr[PrivK^{eav}_{\mathcal{A}, \Pi}(n)=1]\leq \frac{1}{2}+negl(n)$$

#### Def. Pseudorandom Generator

G is a deterministic polynomial-time algorithm such that for any $n$ and any input $s\in \{0,1\}^{n}$, the result $G(s)$ is a string of length $\ell(n)$. G is a **pseudorandom generator** if the following coditions hold:
1. **Expansion:** For every n it holds that $\ell(n)> n$
2. **Pseudorandomness:** For any PPT alogorigthm D, there is a negligible funciton $\mathsf{negl}$, such that: $$\vert Pr[D(G(s))=1]-Pr[D(r)=1]\vert\leq \mathsf{negl}(n)$$, where the first probability is taken over uniform choice of $s\in\{0,1\}^{n}$ and the randomness of D, and the second probability is taken over uniform choice of $r\in\{0, 1\}^{\ell(n)}$ and the randomness of $\mathrm{D}$.

We call $\ell(n)$ the expansion factor of $\mathrm{G}$.

### Def. Pseudorandom Function

An efficient, length preserving, keyed function $F : \{0,1\}^* \times \{0,1\}^* \rightarrow \{0,1\}^*$ is a pseudorandom function if for all PPT distinguishers $D$, there is a negligible function $\text{negl}$ such that: 
$$\left| \Pr[D^{F_k(\cdot)}(1^n) = 1] - \Pr[D^{f(\cdot)}(1^n) = 1] \right| \leq \text{negl}(n)$$
where the first probability is taken over uniform choice of $k \in \{0,1\}^n$ and the randomness of $D$, and the second probability is taken over uniform choice of $f \in \text{Func}$, and the randomness of $D$.

$$G(s)\stackrel{def}{=}F_{s}(1)\Vert F_{s}(2)\Vert \dots F_{s}(\ell)$$

#### Const. EVA-Secure Scheme

fixed-length private-key encryption scheme for messages of length $\ell(n)$ as:
- $\mathsf{Gen}$: input $1^{n}$, choose uniform $k\in{0, 1}^{n}$ as key.
- $\mathsf{Enc}$: input $k$, $m\in{0, 1}^{\ell(n)}$, output: $c:=G(k)\oplus m$
- $\mathsf{Dec}$: $m:=G(k)\oplus c$

#### Thm.

$\Pi$ is perfectly indistinguishable if for all attackers $\mathcal{A}$, holds that: $$Pr[\mathsf{PrivK}^{eav}_{\mathcal{A},\Pi} =1]=\frac{1}{2}$$

***Perfectly Indistinguishable $\equiv$ Perfect Secret***

## CPA-Secure

### PriKE CPA Exp

**The CPA indistinguishability experiment** $\text{PrivK}^{\text{cpa}}_{A,\Pi}(n)$:
1. A key $k$ is generated by running $\text{Gen}(1^n)$.
2. The adversary $A$ is given input $1^n$ and oracle access to $\text{Enc}_k(\cdot)$, and outputs a pair of messages $m_0, m_1$ of the same length.
3. A uniform bit $b \in \{0, 1\}$ is chosen, and then a ciphertext $c \leftarrow \text{Enc}_k(m_b)$ is computed and given to $A$.
4. The adversary $A$ continues to have oracle access to $\text{Enc}_k(\cdot)$, and outputs a bit $b'$.
5. $\text{PrivK}^{\text{cpa}}_{A,\Pi}(n)=1$ if $b' = b$, and $0$ otherwise. In the former case, we say that $A$ succeeds.

$\Pi = (\text{Gen}, \text{Enc}, \text{Dec})$ is CPA-secure if for all PPT adversaries $A$, there is a negligible function $\text{negl}$ such that:
$$ \Pr[\text{PrivK}^{\text{cpa}}_{A,\Pi}(n) = 1] \leq \text{negl}(n). $$

## CCA-Secure

In CCA1 (Lunchtime Attack Security, Static Chosen-Ciphertext Attack Security), the adversary has access to the decryption oracle **only before** the challenge ciphertext is generated. Once the challenge ciphertext is provided, the adversary **loses access to the decryption oracle**.

In CCA2 (Adaptive Chosen-Ciphertext Attack Security, Full Chosen-Ciphertext Security), the adversary can continue to access the decryption orcale after seeing the challenge ciphertext, with the only restriction being that the adversary **cannot query the decryption oracle on the challenge ciphertext itself**. Naturally, CCA2 model is stronger than CCA1.

### Def. Malleability

A scheme is **malleable** means it is possible to modify a ciphertext and thereby cuase a predictable change to plaintext.

### PriKE IND-CCA1 Exp

**The CCA1 indistinguishability experiment**:

- A key $k$is generated by running $\mathrm{Gen}(1^n)$.
- The adversary $\mathcal{A}$ is given input $1^{n}$ and has oracle access to both the encryption oracle $\mathrm{Enc}_k(\cdot)$ and the decryption oracle $\mathrm{Dec}_k(\cdot)$.
- The adversary uses this access to output a pair of equal-length messages $m_0, m_1$.
- A uniform bit $b \in \{0,1\}$ is chosen, and the challenge ciphertext $c \leftarrow \mathrm{Enc}_k(m_b)$ is computed and provided to $\mathcal{A}$.
- After this point, the adversary **can no longer access** the decryption oracle.
- Eventually, $\mathcal{A}$ outputs a guess bit $b'$. 

A private-key encryption scheme $\Pi$ is said to have indistinguishable encryptions under a CCA1 if for all probabilistic polynomial-time adversaries $\mathcal{A}$, there exists a negligible function $\mathrm{negl}$ such that:

$$\Pr[\text{Priv}^{cca1}_{A,\Pi}(n) = 1] \leq \frac{1}{2} + \text{negl}(n)$$

where the probability is taken over all randomness used in the experiment.

### PriKE IND-CCA2 Exp

Formally, CCA give the adversary access to a decryption oracle $\text{Dec}_k(\cdot)$ in addition to an encryption oracle $\text{Enc}_k(\cdot)$. 

Consider the following experiment for any private-key encryption scheme $\Pi = (\text{Gen}, \text{Enc}, \text{Dec})$, adversary $A$, and value $n$ for the security parameter.

**The CCA2 indistinguishability experiment** $\text{Priv}^{cca}_{A,\Pi}(n)$:
- One key $k$ is generated by running $\text{Gen}(1^n)$.
- $\mathcal{A}$ is given input $1^n$ and oracle access to $\text{Enc}_k(\cdot)$ and $\text{Dec}_k(\cdot)$. It outputs a pair of equal-length messages $m_0, m_1$.
- A uniform bit $b \in \{0,1\}$ is chosen, and then a challenge ciphertext $c \leftarrow \text{Enc}_k(m_b)$ is computed and given to $A$.
- The adversary $\mathcal{A}$ continues to have oracle access to $\text{Enc}_k(\cdot)$ and $\text{Dec}_k(\cdot)$ but is not allowed to query the latter on the challenge ciphertext itself. Eventually, $A$ outputs a bit $b'$.
- The output of $\text{Priv}^{cca}_{A,\Pi}(n)$ is $1$ if $b' = b$, and $0$ otherwise.

A private-key encryption scheme $\Pi$ has indistinguishable encryptions under a chosen-ciphertext attack, or is CCA-secure, if for all probabilistic polynomial-time adversaries $\mathcal{A}$ there is a negligible function $\text{negl}$ such that: $$\Pr[\text{Priv}^{cca}_{A,\Pi}(n) = 1] \leq \frac{1}{2} + \text{negl}(n),$$ where the probability is taken over all randomness used in the experiment.

CCA-security implies non-malleability.

### PubKE IND-CCA2 Exp

Given a public-key encryption scheme $\Pi$ and an adversary $\mathcal{A}$, consider the following experiment:

**The CCA indistinguishability experiment** $\text{PubK}^{\text{cca}}_{A,\Pi}(n)$:
1. $\text{Gen}(1^n)$ is run to obtain keys $(pk, sk)$.
2. The adversary $A$ is given $pk$ and access to a decryption oracle $\text{Dec}_{sk}(\cdot)$. It outputs a pair of messages $m_0, m_1 \in M_{pk}$ of the same length.
3. A uniform bit $b \in \{0,1\}$ is chosen, and then a ciphertext $c \leftarrow \text{Enc}_{pk}(m_b)$ is computed and given to $A$.
4. $A$ continues to interact with the decryption oracle, but may not request a decryption of $c$ itself. Finally, $A$ outputs a bit $b'$.
5. $\text{PubK}^{\text{cca}}_{A,\Pi}(n)=1$ if $b' = b$, and $0$ otherwise.

A public-key encryption scheme $\Pi = (\text{Gen}, \text{Enc}, \text{Dec})$ has indistinguishable encryptions under CCA if for all PPT adversaries $\mathcal{A}$ there exists a negligible function $\text{negl}$ such that $$\Pr[\text{PubK}^{\text{cca}}_{A,\Pi}(n) = 1] \leq \frac{1}{2} + \text{negl}(n)$$

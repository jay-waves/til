密码体系有两个准则:
1. Kerchhoff 准则: 安全性不能建立在对算法的保密上.
2. Dolev Yao 准则: 安全协议本身应该与其所具体采用的密码技术分开, 在假定密码技术完善的基础上分析安全协议本身的安全性/正确性/冗余性.

## 安全协议标准

*仲裁协议*中, 可信第三方参与协议执行. *裁决协议*中, 可信第三方不直接参与协议执行; 但当协议产生纠纷时, 双方会向可信第三方 (此时称为裁决方) 提交证据, 由裁决方提供仲裁. 裁决协议中, 裁决者通过双方证据来判断是否存在欺骗, 但并不能直接杜绝欺骗. *自执行协议*中, 协议本身就保证公平性, 如果任意一方欺骗, 会被协议检测出, 立即停止执行. 自执行协议常基于密码学技术设计.

安全协议与一般通信协议的区别是: 有恶意参与者. 安全协议除了协议正确性和效率, 还额外兼顾**安全需求**和**鲁棒性**.

模型组成部分:  
- 参与者类型: 参与者, 攻击者, 可信第三方 (Trusted Third Party), 仲裁者 (Arbiter)
- 参与者间网络连接情况: 同步网络与异步网络, 须考虑时钟周期同步性与消息顺序
- 协议参与者的诚实程度: 诚实参与者, 半诚实参与者 (按协议要求执行, 但监听消息), 恶意攻击者 (不仅监听, 还恶意设计执行方式)
- 协议攻击者的能力 (窃听者, 主动攻击者, 见 [安全模型](obsidian://open?vault=Code&file=Security%2F%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9E%8B))

### 功能分类

1. 密钥建立协议, Key Establishment Protocol.
	- 密钥传输协议
	- 密钥协商协议
1. [认证协议](认证协议.md), Authentication Protocol.
1. 认证的密钥建立协议, 即与已被认证的实体间建立共享秘密.
	- [基于单钥的认证密钥协商](认证的密钥协商协议/基于单钥的认证密钥协商.md)
	- [基于公钥的认证密钥协商](认证的密钥协商协议/基于公钥的认证密钥协商.md)

### 安全性分析

安全协议要进行额外的**安全性分析**, 分析方法主要有: 
- 攻击检测方法, 采用已知攻击方法逐个尝试攻击协议.
- 形式化分析理论与方法, 如 [BAN 逻辑](BAN逻辑.md)
- [可证明安全, 基于困难性问题归约证明](../附录/可证明安全/Provable%20Security.md)

### 攻击手段

若攻击者仅**窃听**, 则称为被动攻击者或窃听者; 如果攻击者不仅窃听, 还控制不诚实协议参与方的行为, 则称为主动攻击者, 或称为 **Byzantine 攻击者**.

主要攻击方法有: 
1. 已知明文攻击
2. 选择密文攻击
3. 预言者会话攻击
4. 并行会话攻击

***

安全协议中所使用的符号定义:

| 标识符        | 含义                             |
| ------------- | -------------------------------- |
| $A$           | Alice 参与方                     |
| $B$           | Bob 参与方                       |
| $T$           | 时间戳                           |
| $R$           | 选取的随机数                     |
| $N$           | 时变值, 也可以代指时间戳或随机值 |
| $K$           | 对称密钥                         |
| $PK, SK$      | 公私钥                           |
| $\set{M}_{K}$, $E_{K}(M)$ | 加密操作                         |
| $H(M)$        | 哈希操作                         |
| $H_{K}(M)$    | 带密钥的哈希操作, 一般指 $MAC$   |

---
url: https://crypto.stackexchange.com/questions/35644/chosen-message-attack-rsa-signature/35656#35656
---

RSA 基于指数运算, 其数学特性导致其易被篡改. 该攻击需要获知 $m_{1}$, 主要用于攻击数字签名场景, 是中间人攻击的一种类型.

## RSA 密文篡改

对于密文 $m_{1}^{e}$, 很容易修改其对应明文:  $m_{2}^{e}\times m_{1}^{e}=(m_{2}m_{1})^{e}$.

若 $m_{2}=m_{1}^{-1}m_{3}$, 就可以将对应明文完全篡改为 $m_{3}$

## RSA 签名攻击

将公钥 $e$ 换成私钥 $d$ 也是同理, 但是更加危险, 因为签名有不可否认性. 

具体而言, 敌手向签名方 (比如某个权威机构) 分别请求 $m_{1}$ 和 $m_{1}^{-1}m_{2}$ 的无害签名, 就能依据上述方法恢复出 $m_{2}$ 的有害签名.

另一种手段是, 请求 $s^{e}$ 的签名, 即得到 $s^{d\times e}\equiv s\pmod n$

***

当然, 该法容易克制, 可以引入时变值, 也可以引入哈希函数, 使 $(m_{2}\Vert N_{1})^{e}\times (m_{1}\Vert N_{2})^{e}\neq(m_{2}m_{1}\Vert N_{3})^{e}$. 

实践中, 请参考 [PKCS#1 PSS 填充算法](../PKCS1.md). 
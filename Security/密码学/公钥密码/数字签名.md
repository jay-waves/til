==数字签名安全目标是**不可否认性**==, 有如下功能:
1. 收方可确认信息来自发方, 且不可伪造.
2. 第三方可确认信息来自发方, 且不可伪造
3. 发方不可否认.
4. 收方不可否认 (收报认证).

|            |   含义  | 哈希函数 | MAC      | 数字签名   |
| ---------- | --- | -------- | -------- | ---------- |
| 完整性<br>(intergrity)   |  消息未被篡改   | Y        | Y        | Y          |
| 真实性<br>(authenticity)     |  接收方消息源认证   | N        | Y        | Y          |
| 不可否认性<br>(non-repudiation) |  第三方消息源认证   | N        | N        | Y          |
| 密钥类型   |     | 无密钥   | 对称密钥 | 非对称密钥 |

数字签名的种类:
1. 带消息恢复的数字签名, 常用方法为**加盐 (添加冗余)**. 使用*可逆*冗余函数对消息进行处理, 消息可从签名中恢复, 所以不要求初始消息 $M$ 作为验证算法输入. $M$ 长度较短或固定.
2. 带附录的数字签名. 要求初始消息 $M$ 为验证算法输入, 使用 $hash(M)$ 进行签名操作. 由于哈希函数求逆困难, 原始消息也作为签名的一部分传输.

## 基于有限域离散对数问题

### 1 [ElGamal数字签名](ElGamal-协议.md)

### 2 Schnorr数字签名

Schnorr也是基于离散对数困难问题设计的, 其首先提出了 $g^{k}\pmod p$可以预计算 (即随机数提前选取计算). 是一种*带附录签名方式*

Schnorr签名选择了大素数 $p$的一个子群进行计算, 从而减少计算量, 速度比ElGamal更快, 但相应安全性更低. 

此外, Schnorr算法没有ElGamal签名长度膨胀两倍的缺点.

#### 2.1 密钥生成

1. 选素数 $p, q$, 使得 $q$是 $p-1$的素因子
2. 选择整数 $g$, 使得 $g^{q}=1\pmod p$, 即 $o(g)= q$
3. 选择随机数 $x$, 计算 $y=g^{-x}\pmod p$

公钥为 $\{y,\ g,\ p,\ q\}$, 私钥为 $\{x\}$

#### 2.2 签名

1. 选随机数 $k$, 计算 $r=g^{k}\pmod p$
2. $e=Hash(m\ \Vert\ r)$, m为待加密消息. 添加后置 $r$ 可以防止[长度延长攻击](../消息摘要/消息认证码/长度延长攻击.md).
3. $s=k+xe\pmod q$

签名为 $(e,\ s)$

#### 2.3 验签

1. 计算 $r'=g^{s}y^{e}\pmod p$
2. 验证 $Hash(m\ \Vert\ r')\equiv e$

其中 $r'\equiv g^{s}y^{e}\equiv g^{k+xe-xe}\equiv g^{k}\pmod p$

> 验签过程中, ElGamal 体制验证的是能否复原 m,  
> Schnorr 体制验证的则是能否复原 r

<br>

### 3 DSA 数字签名算法

DSA 数字签名算法, 是一种基于公钥密码的*带附录数字签名方式*. 用于 [NIST](../../../appx/各类互联网国际标准组织.md) 提出的美国国家标准 [DSS (Digital Signature Standard) 数字签名标准](https://csrc.nist.gov/pubs/fips/186-5/final), DSS 还包括 ECDSA 和RSA.

DSA算法是 Elgamal 签名的变种, 同样基于有限域上离散对数问题. 但它比ElGamal的效率更高, 签名更短. DSA 和 [ElGamal 签名](ElGamal-协议.md) 有一样的安全问题, 即随机数 k 不能重复使用.

DSA 安全性依赖于 $\mathbb{Z}_{p}$ 的 q 阶子群上的 DLP 问题. 这种*大群的小阶子群*的思想来源于 Schnorr.

#### 3.1 密钥生成

1. 选取素数 $p$, `512b` < 字长 < `1024b`
2. 选取素数 $q$, $q\vert p-1$, `159b` < 字长 < `160b` 
3. 选取有限域 $\mathbb{GF}(p)$ 的 $q$ 阶子群的生成元 $g=h^{(p-1)/q}\pmod{p}$, $h\neq 0$, $h^{(p-1)/q}\neq 1\pmod{p}$ 
4. 选取随机数 $0<x<q$, 作为私钥
5. $(p, q, g)$ 为公钥

#### 3.2 签名

$r=[g^{k} \pmod p] \pmod q$, $k$ 为随机数   
$s=[k^{-1}(Hash(M)+xr)]\pmod q$

#### 3.3 验签

收到签名 $\{s, r\}$ 与原消息 $M$:

$m=Hash(M)$  
$u_{1}=[m*s^{-1}]\pmod q$  
$u_{2}=r*s^{-1}\pmod q$  
$v=[g^{u_{1}}*y^{u_{2}}\pmod p]\pmod q$

接下来验证 $v\equiv r$, 因为 $v=[g^{[m+xr]*s^{-1}}\pmod p]\pmod q$

<br>

### [椭圆曲线数字签名 ECDSA](ECC/ECC.md)

基于椭圆曲线域上的离散对数困难问题 ECDLP

## 基于大数分解问题

### [RSA数字签名](RSA/RSA-签名.md)

- ISO 9796: 带消息恢复的数字签名规范
- PKCS #1: 带附录的数字签名规范

|   算法对比           | RSA 签名            | ElGammal 签名               | Schnorr 签名        |
| ------------ | ------------------- | --------------------------- | ------------------- |
| 基于困难问题 | FAC                 | DL                          | DL                  |
| 签名效率     | 一次模幂          | 两次模乘 (随机数可提前生成) | 一次模乘            |
| 验签效率     | 一次模幂, 由于 $d>>e$, 所以比签名效率高           | 一次模乘 + 两次模幂         | 一次模乘 + 两次模幂 |
| 签名长度     | $\leq \vert N\vert$ | $\leq 2\vert p\vert$        | $\leq \vert q\vert + \vert Hash(M)\vert$                    |

由于签名场景中, 产生签名的效率往往比验签效率更加重要, 所以 RSA 不被广泛使用.

###  [Rabin数字签名](Rabin-协议.md)

***

若攻击者能以**不可忽略的概率**完成下列操作 (难度递减), 则称为攻破了该签名方案:

1. 完全攻破 (total break), 可揭示签名者私钥
2. 普遍性/通用伪造 (universal forgery), 可伪造出对任意消息签名的高效签名算法
3. 选择消息伪造 (selective forgery), 可生成某特定消息的有效签名
4. 存在性伪造 (existential foegery), 可至少生成一个消息的有效签名, 但敌手对得到的消息和签名无任何控制作用.

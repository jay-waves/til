**定义**:   
1. 计算机**最基本**系统软件
2. 控制和管理系统的**硬件和软件资源**, 组织调度计算机工作和资源分配
3. 为用户和软件提供**接口与环境**的程序集合

### 操作系统 功能与架构

1. 实现对计算机资源的抽象.
2. 实现处理机调度, 存储器管理, 文件管理和I/O设备管理.
3. 提供用户接口与程序接口. 如 CLI, GUI, API

其架构为:

```
1 | 用户 |
2 | 非内核功能 |
3 | 进程管理 | 存储器管理 | I/O设备管理 | 
4 | 时钟管理 | 中断处理 | 原语操作 |
5 | 硬件 |
```

4和5为操作系统内核. 4是微内核.

[安卓系统五层架构](../../attach/Pasted%20image%2020230620164006.png).

### 操作系统 特征
其中并发和共享是基本特征.

#### 1 并发 Concurrence

并行性: 多个事件同一时刻发生.

并发性: 多个事件宏观上同时发生, 微观上交替发生.

CPU单核通过**分时**实现并发, 通过多核实现并行.

#### 2 共享 Sharing

互斥共享: 一段时间只允许一个进行访问某资源 (称为**临界资源**). 如麦克风, [variables](../../Shell/Bash/variables.md)等.

同时访问方式: 一段时间允许多个进程"同时"访问 (虽然微观可能仍是分时访问的). 比如磁盘.

#### 3 虚拟 Virtual

如虚拟内存, 虚拟处理机和虚拟外部设备. 让用户感觉自己独自占有使用某资源.

#### 4 异步 Asynchronism

资源有限与处理分时, 导致程序以不可预知的速度向前推进.


### 中断与异常

现代操作系统的显著特点是: ==中断驱动==. 中断是让内核程序夺回CPU使用权的唯一途径. 中断包括:  
- 外中断: 由硬件引起, 中断信号来自CPU外部. 如时钟中断/IO中断
- 内中断 (**异常**): 由软件引起, 信号来自CPU内部. 有 **陷入**(trap, 程序引发, 请求系统调用), **故障**(fault, 指可被内核程序修复的错误. 如缺页故障.), **终止**(abort, 致命错误, CPU不会再归还使用权, 而直接终止该程序. 如整除0, 非法使用特权指令.)

#### I/O操作 中断处理

![|400](../../attach/Pasted%20image%2020230618230129.png)

1. CPU通过I/O指令通知I/O设备控制器.
2. 控制器操作具体设备执行I/O操作, CPU执行其他指令.
3. I/O完成后, 控制器触发中断, 通知CPU
4. CPU根据中断号查询**中断向量表, 执行中断处理程序**.

#### 执行系统调用

![|500](../../attach/Pasted%20image%2020230618231116.png)

![400](../../attach/Pasted%20image%2020230618231521.png)


## IVP 问题

给定常微分方程及其初值:   

$$\begin{cases}
y'(t)  & =  & f(t, y), \quad t \in [t_{0}, T]\\ 
y(t_{0}) & = & y_{0}
\end{cases}$$

目标是求满足上式的函数 $y(t)$. 方程的解析解为: 

$$y(t) = y_0 + \int_{t_0}^t f(s, y(s))\,ds$$

当求解析解很困难时, 需要逼近该方程, 直接求某个位置 $t_{i}$ 上的数值解 $y(t_{i})$. 迭代求解 IVP 问题时, 需要平衡舍入误差与截断误差: 当迭代步长过小, 计算机浮点数舍入误差会积累, 并且迭代速度过慢; 当迭代步长过大, 截断误差导致数值稳定性下降.


### 假设条件

要保证 "解存在且唯一" , 通常对右端 $f(t,y)$ 要求: 
1. 连续性: $f(t, y)$ 在区域内连续, 保证解存在
2. 满足 Lipschitz 条件: 存在常数 $L > 0$, 使得任意 $y_{1},y_{2}$ 满足: $$|f(t, y_1) - f(t, y_2)| \le L |y_1 - y_2|$$

## 单步迭代法

把区间 $[t_{0},T]$ 用步长 $h$ 划分: $t_n = t_0 + nh,\quad n=0,1,\dots$

已知近似值 $y_n \approx y(t_n)$, 继续单步迭代 (单步, 指仅依赖当前点进行迭代):
 
$$y_{n+1} = y_n + h\times\phi(t_n, y_n, h)$$

其中 $\phi$ 是某种斜率近似, 称为增量函数. 

### 单步迭代法的误差

定理: 
**如果增量函数 $\phi$ 对 $y$ 满足 Lipschitz 条件, 并且单步法的*局部截断误差*是 $R_{n+1}=O(h^{p+1})$, 那么单步法的*全局误差*为: $e_{n+1}=O(h^{p})$**

证明:

* 全局误差是: $e_{n}=y(t_{n})-y_{n}$
* 局部截断误差: $R_{n+1}=y(t_{n+1}) -y(t_{n})-h\phi(t_{n},y(t_{n}),h)$
* 迭代次数: $n\approx \frac{t_{n}-t}{h}$

![|600](http://oss.jay-waves.cn/til/单步迭代法的误差证明.png)

单步迭代法的全局误差为 $O(h^p)$, 那么就称其为 $p$ 阶方法.

## Runge–Kutta (RK) 方法

RK 法仍是单步跌打法, 但是每步估计"增量函数"的方法不同.

最一般的 s 阶 RK 公式:
 
$$\begin{cases}  
k_1 &= f(t_n,, y_n), \\  
k_2 &= f\bigl(t_n + a_{2} h,; y_n + hb_{21}k_1\bigr), \\
&\vdots \\  
k_s &= f\bigl(t_n + a_s h,; y_n + h\sum_{j=1}^{s-1} b_{sj} k_j\bigr), \\  
y_{n+1} &= y_n + h \sum_{i=1}^s c_i k_{i},\\
a_{s}&=\sum^{s-1}_{j=1}b_{sj}
\end{cases}$$  

* 所有 $a_{i}, b_{ij}, c_{i}$ 都是待定系数.
* $k_{i}$ 代表不同位置的"试探斜率"
    
**欧拉法是一阶 RK 方法, 改进欧拉法是二阶 RK 方法**.

### 欧拉法

欧拉法直接使用 $f(t_{n},y_{n})$ 作为增量函数:

$$y_{n+1} = y_n + h f(t_n, y_n)$$

欧拉法的全局误差为 $O(h)$, 稳定性较差.

### 隐式欧拉法/后向欧拉法

$$y_{n+1}=y_{n}+hf(t_{n+1},y_{n+1})$$ 

即 $$y_{n+1}-hf(t_{n+1},y_{n+1})=y_{n}$$

适合刚性问题. 缺点是每一步都要求解一个非线性方程.

### 修正欧拉法/显式梯形法

本质是用两点平均斜率代替单点斜率. 迭代公式为:

$$\begin{aligned}  
k_1 &= f(t_n, y_n), \\  
k_2 &= f(t_n + h, y_n + hk_1), \\  
y_{n+1} &= y_n + \frac{h}{2}(k_1 + k_2)
\end{aligned}  $$

全局误差为 $O(h^{2})$

## 舍入误差

P199

## 稳定函数

模型方程: $y'=\lambda y, \lambda\in \mathbb{C}$

带入数值迭代法, 得到稳定函数: $y_{n+1}=R(h\lambda)y_{n}$ 

当 $|R(h\lambda)|<1$ 时, 数值方法每一步均衰减, 因此数值解是稳定的. (但精度不保证.)
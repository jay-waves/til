## 多项式友矩阵

$f(\lambda)=\lambda^{n}+a_{n-1}\lambda^{n-1}+\dots+a_{1}\lambda+a_{0}$ 

定义 $f(\lambda)$ 的*友矩阵*为: $$A=\begin{bmatrix}
0 & 1 & 0 & \dots & 0 \\
0 & 0 & 1 & \dots & 0 \\
\vdots & \vdots  & \vdots  & \ddots  \\
0 & 0 & 0 & \dots & 1 \\
-a_{0} & -a_{1} & -a_{2} & \dots & -a_{n-1}
\end{bmatrix}$$

或者: $$A=\begin{bmatrix}
0 & 0 & \dots & 0 & -a_{0} \\
1 & 0 & \dots & 0 & -a_{1} \\
0 & 1 & \dots & 0 & -a_{2} \\
\vdots & \vdots & \dots  & \vdots  \\
0 & 0 & \dots & 1 & -a_{n-1}
\end{bmatrix}$$

## 多项式插值

多项式插值 (Polynomial interpolation) 是寻找通过点 $\set{(x_{0},y_{0}),\ (x_{1},y_{1}),\ (x_{2},y_{2}),\ \dots,\ (x_{n}, y_{n})}$ 的最低次多项式曲线: $$P_{n}(x)=a_{0}+a_{1}x+a_{2}x^{2}+\cdots+a_{n}x^{n}$$ 使得 $P(x_{i})=y_{i}$. 对于 $n$ 次多项式 $P_{n}(x)$, 根据[线性方程组](../线性代数/线性方程组/线性方程组的解.md)理论, 至少需要 $n+1$ 个点 $(x_{i},y_{i})$ 来确定**唯一**解: 

$$\array{P_{n}(x_{0})=y_0\\P_{n}(x_{1})=y_{1}\\ \vdots\\ P_{n}(x_{n})=y_{n} }$$

可以通过矩阵直接求解系数, 也可以通过拉格朗日插值法和牛顿插值法.

**插值是函数的相反操作**, 函数通过曲线确定点, 插值通过点寻找曲线. **插值是级数拟合的一种方式**, 其他方式还有: [傅里叶级数](../微积分/傅里叶级数.md), [泰勒级数](../微积分/泰勒级数.md), 幂级数和函数, 线性回归.

### 拉格朗日插值

对于一系列互异点 $\set{(x_{0},y_{0}),\ (x_{1},y_{1}),\ (x_{2},y_{2}),\ \dots,\ (x_{n}, y_{n})}$, 拉格朗日插值 (Lagrange Interpolation) 给出的拟合曲线为:

$$P(x)=\sum^{n}_{i=0}y_{i}\cdot L_{i}(x)$$

$$L_{i}(x)=\prod_{0\leq j\leq n,\ j\neq i}\frac{x-x_{j}}{x_{i}-x_{j}}$$

每个拉格朗日算子 $L_{i}(x)$ 是 $n$ 阶多项式, 并且满足: $$L_{i}(x_{j})=\cases{0,\ i\neq j\\1,\ i=j}$$

### 牛顿插值

牛顿插值 (Newton Interpolation) 公式:

$$P(x)=a_{0}+a_{1}(x-x_{0})+a_{2}(x-x_{0})(x-x_{1})+\dots+a_{n}(x-x_{0})\dots (x-x_{n-1})$$

其中 $a_{i}$ 被称为差商 (divided differences), 可以递推计算:

- 0 阶差商: $f[x_i] = f(x_i)$
- 1 阶差商: $$f[x_i, x_{i+1}] = \frac{f(x_{i+1}) - f(x_i)}{x_{i+1} - x_i}$$
- 2 阶差商: $$f[x_i, x_{i+1}, x_{i+2}] = \frac{f[x_{i+1}, x_{i+2}] - f[x_i, x_{i+1}]}{x_{i+2} - x_i}$$
- n 阶差商: $$f[x_0, x_1, \ldots, x_n] = \frac{f[x_1, \ldots, x_n] - f[x_0, \ldots, x_{n-1}]}{x_n - x_0}$$

定义 $a_{i}=f[x_0, x_1, \ldots, x_i]$

![](../../attach/差商表.avif)

牛顿插值的优点是: 已用 $n$ 个点求出插值公式后, 有新的点加入, 只需计算新项 $a_{n+1}$ 即可, 不需要重新计算所有系数.

#### 误差

$R_{n}(x)=f(x)-p_{n}(x)$

记 $w_{n+1}(x)=(x-x_{0})(x-x_{1})\dots(x-x_{n})$, 而 $I_{x}$ 为包含所有 $x_{i}$ 的最小闭区间. $f(t)$ 在 $I_{x}$ 上有 $n+1$ 阶导数.

那么插值误差为: $$R_{n}(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}w_{n+1}(x)$$ 其中 ${} \xi\in \hat I_{x} {}$ 且依赖于 $x$. 

<br>

**证明**: 

当 $x=x_{i}$ (插值点) 时, $R_{n}\equiv 0$ .

当 $x\neq x_{i}$ 时, 取辅助函数 $$F(t)=[f(t)-p_{n}(t)]-[f(x)-p_{n}(x)] \frac{w_{n+1}(t)}{w_{n+1}(x)}$$

$F(x)=0$, $F(x_{i})=0$, 因此 ${} F(t) {}$ 在 $I_{x}$ 内有 ${} n+2 {}$ 个零点. 由罗尔定理可知, $F^{(n+1)}(t)$ 在 $I_{x}$ 开区间内有 $1$ 个零点: 

$$F(\xi)=0=f^{(n+1)}(\xi)-[f(x)-p_{n}(x)] \frac{(n+1)!}{w_{n+1}(x)}$$

那么: $$R_{n}(x)=f(x)-p_{n}(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}w_{n+1}(x)$$

#### 卡尔龙格现象

Runge Phenomenon (Carl Runge) 发现高次多项式插值并不稳定, 数据点之间出现了显著震荡和偏差, 尤其是区间端点附近.

Runge 函数: $$f(x) = \frac{1}{1 + 25x^2}$$

该函数在 $[-1,1]$ 上连续光滑, 取该区间的等距间断点:
- 当插值阶数较小时 ($n=5$), 插值多项式较好逼近了原函数.
- 当插值阶数增大时 ($n=10$), 区间两端出现了明显震荡, 阶数越高震荡越剧烈.

### 埃尔米特插值 (Hermite)


### 平方逼近

设 ${} \varphi_{i}(x) {}$ 皆是 $[a,b]$ 上的连续函数, 且在 $[a,b]$ 上线性无关. 它们张成空间 ${} H_{n}=span\set{\varphi_{0},\varphi_{1},\dots,\varphi_{n}} {}$, $H_n$ 是 $C[a,b]$ 的子空间. 对于任意 $p(x)\in H_{n}$, 有 $p(x)=\sum^{n}_{j=0}c_{j}\varphi_{j}(x)$

在 $C[a,b]$ 上, 定义两个函数的内积为: $$(f,g)=\int^{b}_{a}f(x)g(x) \, dx$$

#### 定义-最佳平方逼近

**给定函数 $f(x)\in C[a,b]$, 若 $p^{*}(x)\in H_{n}$ 满足: $$(f-p^*,f-p^*)=\min_{p\in H_{n}}(f-p,f-p)$$ 则称 $p^*$ 为子空间 $H_{n}$ 对于 $f(x)$ 的最佳平方逼近元**

#### 定理1

**$p^{*}(x)$ 是 $f(x)$ 的最佳平方逼近元的充要条件为: $$(f-p^{*},\varphi_{j})=0\quad(j=0,1,\dots,n)$$**

推论, $\forall p(x)\in H_{n}$, 总有: $(f-p^{*},p)=0$. 

设 ${} p^{*}(x)=\sum^{n}_{k=0}c_{k}^{*}\varphi_{k}(x) {}$, 因为 $$(f-p^{*},\varphi_{j})=(f,\varphi_{j})-\sum^{n}_{k=0}c_{k}^{*}(\varphi_{k},\varphi_{j})$$, 所以 $$\sum^{n}_{k=0}c_{k}^{*}(\varphi_{k},\varphi_{j})=(f,\varphi_{j})\quad (j=0,1,\dots,n)$$ 这个 n+1 阶方程的解存在且唯一. 

#### 定理2

**对于 $f(x)$, 最佳平方逼近元 $p^{*}(x)$ 是唯一的**.

#### 定义-最佳平方逼近误差

**记 $\delta=(f-p^{*},f-p^{*})$ 为最佳平方逼近误差**. 因为 $(f-p^{*},p^{*})=0$, 所以 $$\delta=(f-p^{*},f)=(f,f)-(p^{*},f)=(f,f)-\sum^{n}_{k=0}c^{*}_{k}(\varphi_{k},f)$$

### 正交函数系下的最佳平方逼近

